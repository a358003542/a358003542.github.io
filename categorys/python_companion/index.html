<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="msvalidate.01" content="55CB117A61A6F8286173763FB18D9625"/>

        <meta name="author" content="wanze"/>
        <meta name="copyright" content="wanze"/>

        <meta name="description"
              content="欢迎来到本网站，希望本网站的文章能够对您有所帮助。"/>

            <meta property="og:type" content="article"/>
        <meta name="twitter:card" content="summary">

        <meta property="og:title" content="wanze的博文"/>
        <meta name="twitter:title" content="wanze的博文">
    <meta property="og:url" content="https://a358003542.github.io"/>
        <meta property="og:description" content="欢迎来到本网站，希望本网站的文章能够对您有所帮助。"/>
        <meta name="twitter:description" content="欢迎来到本网站，希望本网站的文章能够对您有所帮助。">
    <meta property="og:site_name" content="wanze的博文"/>
    <meta property="og:article:author" content="wanze"/>

    <title>wanze的博文 - python_companion category</title>

        <link href="https://a358003542.github.io/theme/css/font-awesome.css" rel="stylesheet"
              media="screen">
        <link href="https://a358003542.github.io/theme/css/bootstrap.min.css" rel="stylesheet"
              media="screen">

        <link rel="stylesheet" type="text/css"
                  href="https://a358003542.github.io/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css"
                  href="https://a358003542.github.io/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css"
                  href="https://a358003542.github.io/theme/css/base.css" media="screen">




</head>
<body>

<nav class="navbar">
    <div class="navbar navbar-default" role="navigation">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed"
                    data-toggle="collapse" data-target=".navbar-collapse"
                    aria-expanded="false">
                <span class="sr-only">Navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <a class="navbar-brand" href="https://a358003542.github.io/"><span
                    class=site-name>网站首页</span></a>
        </div>


        <div class="navbar-collapse collapse">
            <form action="https://a358003542.github.io/search.html"
                  onsubmit="return validateForm(this.elements['q'].value);"
                  class="navbar-form navbar-left">
                <div class="form-group">
                    <input type="text" name="q" id="tipue_search_input"
                           class="form-control" placeholder="Search..."
                           style="width:430px;">
                </div>
                <button class="btn btn-default" type="submit">搜索</button>
            </form>


            <ul class="nav navbar-nav nav-pills navbar-right">
                <li >
                    <a  href="/archives.html">所有文章</a></li>

                <li ><a href="/categories.html">文章分类</a></li>
                <li ><a href="/tags.html">文章标签</a></li>


                        <li >
                            <a href="https://a358003542.github.io/about.html">关于本网站</a>
                        </li>
            </ul>


        </div>
    </div>
</nav>


<div class="container-fluid">
    <div class="col-md-1 col-md-1-left"></div>
    <div class="col-md-10">

    <style>
        article {
            border: 1px solid #aaa;
        }

        section {
            padding: 1em;
        }

        article > p {
            padding-left: 0.5em;
            padding-right: 0.5em;
        }

    </style>


    <div class="row">

        <div class="row">
         </div>

             <div class="row">
                <div class="col-md-8 col-md-offset-2">
                    <header>
                        <h1 id="recent-posts">最近博文
                            <a id="allposts" href="https://a358003542.github.io/archives.html">所有博文</a>
                        </h1>
                    </header>


                    <div class="recent-posts">

                            <article>

                                <h1 class="page-header"><a
                                        href="https://a358003542.github.io/articles/sqlalchemy-module.html">sqlalchemy模块
 </a></h1>

                                <section>
                                    posted in
                                    <a href="https://a358003542.github.io/categories.html#python_companion-ref">python_companion
                                    </a>
                                    <div class="recent-posts-time">
                                        <time pubdate="pubdate"
                                              datetime="2020-03-25T05:12:12.311432+08:00">2020年 3月 25日
                                        </time>
                                    </div>
                                </section>
                                
<h2 id="_1">前言</h2>
<p>本文分为两个部分，sqlalchemy的非ORM部分和ORM部分。一般使用是推荐使用ORM，这将让你的代码更python，更易读易懂。但ORM部分要用好，很多非ORM部分知识是需要的,，下面根据笔者的实践列出一些非ORM部分非常常用的一些知识部分：</p>
<ul>
<li>创建Engine 理解创建Engine部分将有助于你在很多地方理解如何配置sqlalchemy的数据库连接</li>
<li>列的属性 列的数据类型 这两个是必看的，你在定义ORM模型的时候必然要参考这个</li>
<li>select语句和理解RowProxy对象 帮助你理解如何在query中编写select语句和出来的结果如何使用</li>
</ul>
<h3 id="_2">安装</h3>
<p>sqlalchemy的安装简单用pip命令安装之即可:</p>
<div class="highlight"><pre><span></span><code>pip install sqlalchemy
</code></pre></div>
<h3 id="_3">引用惯例</h3>
<p>在后面都默认有如下引用:</p>
<div class="highlight"><pre><span></span><code>from sqlalchemy import *
</code></pre></div>
<p>后面将不会再提及，也就是凡是 <code>from sqlalchemy import what</code> 的所有语句也都归于如上一条引用。实践中并不推荐这种的全局引用。</p>
<h2 id="_4">简介</h2>
<p>通过sqlalchemy连接具体的某个数据库，前面有一些准备工作要做，参考 <a href="http://www.aosabook.org/en/sqlalchemy.html">sqlalchemy architecture</a> 一文的描述:</p>
<p><img alt="img" src="https://a358003542.github.io/images/python/layers.png" title="SQLAlchemy layer diagram"/></p>
<p>和数据库直接相连的是我们熟悉的那些DBAPI接口模块，比如: sqlite3, pymysql, psycopg2等，然后中间的核心层有Engine，连接池，方言 …</p>
                            </article>


                            <article>

                                <h1 class="page-header"><a
                                        href="https://a358003542.github.io/articles/pytestmo-kuai.html">pytest模块
 </a></h1>

                                <section>
                                    posted in
                                    <a href="https://a358003542.github.io/categories.html#python_companion-ref">python_companion
                                    </a>
                                    <div class="recent-posts-time">
                                        <time pubdate="pubdate"
                                              datetime="2020-03-19T05:08:04.053293+08:00">2020年 3月 19日
                                        </time>
                                    </div>
                                </section>
                                
<h2 id="unittest">unittest模块</h2>
<p>编写python测试代码，学习pytest模块之前，必须先学习和了解python官方模块 <strong>unitest</strong> 。首先上例子：</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="k">class</span> <span class="nc">TooBigError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TooBigError</span><span class="p">(</span><span class="s1">'too big input error'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'hello'</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">FirstTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""setUp函数在每个测试单元执行前被执行，其通常用于预先配置</span>
<span class="sd">        一些后面测试单元会用到的参数"""</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""tearDown函数在每个测试单元执行之后再执行。"""</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">test_bool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""具体的测试单元 …</span></code></pre></div>
                            </article>


                            <article>

                                <h1 class="page-header"><a
                                        href="https://a358003542.github.io/articles/jinja2-template-engine.html">jinja2模板引擎
 </a></h1>

                                <section>
                                    posted in
                                    <a href="https://a358003542.github.io/categories.html#python_companion-ref">python_companion
                                    </a>
                                    <div class="recent-posts-time">
                                        <time pubdate="pubdate"
                                              datetime="2020-03-09T03:48:37.742417+08:00">2020年 3月 9日
                                        </time>
                                    </div>
                                </section>
                                
<h2 id="_1">前言</h2>
<p>jinja2模板引擎在flask和pelican中都有使用，而且就是在django框架中，模版语法也大体类似，所以jinja2模板引擎还是很值得一学的。</p>
<p>jinja2模板引擎作为python的模块简单的使用如下所示：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">jinja2</span> <span class="kn">import</span> <span class="n">Template</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="n">template_content</span><span class="p">)</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">link_data</span><span class="o">=</span><span class="n">link_data</span><span class="p">)</span>
</code></pre></div>
<p>这里的render函数就是将一些参数变量渲染进去，从而得到目标文本内容。</p>
<p>本文接下来的简要讨论下如何在flask或者pelican中编写模板文件，更详细的内容请参见 <a href="http://docs.jinkan.org/docs/jinja2/templates.html">官方文档模板设计者文档一章</a> 。</p>
<h2 id="_2">注释</h2>
<p>注释写法如下所示，之所以这个放在最前面是因为模板引擎里面注释有时很有用，但很不同于其他编程语言里面的注释写法。</p>
<div class="highlight"><pre><span></span><code>{# this is a comment #}
</code></pre></div>
<h2 id="_3">变量</h2>
<p>如下所示，里面包含某个变量，jinja2渲染模板的时候会解析这些变量。</p>
<div class="highlight"><pre><span></span><code>{{ variable_name }}
</code></pre></div>
<p>然后 <code>object.a</code> 这样的dot法引用，或者 <code>object['a']</code> 这样的写法，甚至是调用实例的某个方法 <code>object.func()</code> 也是可以的，如果这个方法返回某个字符串的话。</p>
<p>有的时候我们需要debug一些变量一般是如上将这个变量值显示出来 …</p>
                            </article>


                            <article>

                                <h1 class="page-header"><a
                                        href="https://a358003542.github.io/articles/pelican-module.html">pelican模块
 </a></h1>

                                <section>
                                    posted in
                                    <a href="https://a358003542.github.io/categories.html#python_companion-ref">python_companion
                                    </a>
                                    <div class="recent-posts-time">
                                        <time pubdate="pubdate"
                                              datetime="2020-03-07T01:27:46.117959+08:00">2020年 3月 7日
                                        </time>
                                    </div>
                                </section>
                                
<h2 id="_1">简介</h2>
<p>pelican是一个静态网站生成工具，其是用python编写实现的，所以对于pythoner来说显得格外的亲切。</p>
<p>首先按照官方的quickstart简单的刷一遍吧，下面就一些问题作出一些讨论。</p>
<h2 id="_2">项目基本说明</h2>
<p>python的虚拟环境控制这里就不多说了，下面主要讨论 <code>pelicanconf.py</code> 和 <code>publishconf.py</code> 和 <code>Makefile</code> 这个文件作出一些说明，然后项目文档的基本结构相关作出一些说明。</p>
<p>首先说明下 <code>publishconf.py</code> 和 <code>pelicanconf.py</code> 的区别， <code>publishconf.py</code> 文件里面有这样一句话：</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">curdir</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pelicanconf</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre></div>
<p>也就是其将继承所有来自 <code>pelicanconf.py</code> 里面的配置参量，不同的是 <code>publishconf.py</code> 是针对发布到远程服务器上的，而 <code>pelicanconf …</code></p>
                            </article>


                            <article>

                                <h1 class="page-header"><a
                                        href="https://a358003542.github.io/articles/requests-module.html">requests模块
 </a></h1>

                                <section>
                                    posted in
                                    <a href="https://a358003542.github.io/categories.html#python_companion-ref">python_companion
                                    </a>
                                    <div class="recent-posts-time">
                                        <time pubdate="pubdate"
                                              datetime="2020-03-07T00:15:45.249600+08:00">2020年 3月 7日
                                        </time>
                                    </div>
                                </section>
                                
<h1 id="urllibrequest">urllib.request内置模块</h1>
<p>urllib.request模块我们可以在这里稍微了解一下，但一般实际使用主要是用后面要介绍的 <strong>requests</strong> 模块。</p>
<h2 id="urlopen">urlopen函数</h2>
<p>urlopen函数在urllib模块的request子模块，其提供了简单的获取目标url网页内容的接口。一个简单的例子如下所示：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="n">socket</span><span class="o">.</span><span class="n">setdefaulttimeout</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'https://www.google.com.cn'</span><span class="p">,</span><span class="s1">'https://www.google.com'</span><span class="p">,</span>
    <span class="s1">'http://www.google.com.cn'</span><span class="p">]</span>

<span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">)</span>
        <span class="nb">print …</span></code></pre></div>
                            </article>


                            <article>

                                <h1 class="page-header"><a
                                        href="https://a358003542.github.io/articles/beautifulsoup-module.html">beautifulsoup模块
 </a></h1>

                                <section>
                                    posted in
                                    <a href="https://a358003542.github.io/categories.html#python_companion-ref">python_companion
                                    </a>
                                    <div class="recent-posts-time">
                                        <time pubdate="pubdate"
                                              datetime="2020-03-07T00:14:15.887446+08:00">2020年 3月 7日
                                        </time>
                                    </div>
                                </section>
                                
<h1 id="_1">简介</h1>
<p>BeautifulSoup模块在python网页分析这一块是很有名的一个模块，其确实让网页分析任务变得轻松而easy了。本文将对bs4模块进行简单的介绍，更多细节请参看 <a href="http://www.crummy.com/software/BeautifulSoup/bs4/doc/">官方文档</a> 。</p>
<h2 id="_2">安装</h2>
<p>安装就简单用pip命令安装之:</p>
<div class="highlight"><pre><span></span><code>sudo pip install beautifulsoup
</code></pre></div>
<h2 id="_3">第一个例子</h2>
<p>然后在使用上因为python2和python3的urllib相关改动很大，加上urllib在使用上不是很友好，强烈推荐大家直接用requests模块来进行相关操作。然后beautifulsoup的引入语句一般如下所示:</p>
<div class="highlight"><pre><span></span><code>from bs4 import BeautifulSoup
</code></pre></div>
<p>最简单的和requests的组合使用如下所示:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"http://www.pythonscraping.com/exercises/exercise1.html"</span><span class="p">)</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</code></pre></div>
<p>在上面soup.title返回的是一个标签对象。然后标签对象里面如果有标签的话又可以继续点号索引标签:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; soup.body …</code></pre></div>
                            </article>


                            <article>

                                <h1 class="page-header"><a
                                        href="https://a358003542.github.io/articles/click-module.html">click模块
 </a></h1>

                                <section>
                                    posted in
                                    <a href="https://a358003542.github.io/categories.html#python_companion-ref">python_companion
                                    </a>
                                    <div class="recent-posts-time">
                                        <time pubdate="pubdate"
                                              datetime="2020-03-04T23:02:59.160945+08:00">2020年 3月 4日
                                        </time>
                                    </div>
                                </section>
                                
<h2 id="_1">简介</h2>
<p>click模块是一个类似getopt和argparse的python第三方模块，在简单了解之后，觉得其简直就是python快速创建命令行工具的类似requests之于urllib的存在，writed human-friendly。click的官方文档在 <a href="http://click.pocoo.org">这里</a> ，下面就让我们来学习这么好的一个模块吧。</p>
<p>官方文档的第一个例子如下:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">click</span>

<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">'--count'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">'Number of greetings.'</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">'--name'</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="s1">'Your name'</span><span class="p">,</span>
              <span class="n">help</span><span class="o">=</span><span class="s1">'The person to greet.'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="sd">"""Simple program that greets NAME for a total of COUNT times."""</span>
    <span class="k">for …</span></code></pre></div>
                            </article>

                     </div>
                </div>
            </div>
    </div>

    </div>
    <div class="col-md-1"></div>

</div>


<div id="push"></div>
<button id="gotop" type="button" class="btn btn-default">
    <span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span>
</button>

<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a> and updated by <a href="https://github.com/a358003542" title="wanze Home Page">wanze</a></li>
    </ul>
</div>
</footer>

        <script src="https://a358003542.github.io/theme/js/jquery.min.js"></script>
    <script src="https://a358003542.github.io/theme/js/bootstrap.min.js"></script>

    <script src="https://a358003542.github.io/theme/js/base.js"></script>

    <script>
        (function ($) {
            // custom css expression for a case-insensitive contains()
            jQuery.expr[':'].Contains = function (a, i, m) {
                return (a.textContent || a.innerText || "").toUpperCase().indexOf(m[3].toUpperCase()) >= 0;
            };

            function listFilter() {

                $('#findtag')
                    .change(function () {
                        var filter = $(this).val();
                        if (filter) {
                            // this finds all links in a list that contain the input,
                            // and hide the ones not containing the input while showing the ones that do
                            $('.list-of-tags').find("a:not(:Contains(" + filter + "))").parent().hide();
                            $('.list-of-tags').find("a:Contains(" + filter + ")").parent().show();
                        } else {
                            $('.list-of-tags').find("li").show();
                        }
                        return false;
                    })
                    .keyup(function () {
                        // fire the above change event after every letter
                        $(this).change();
                    });
            }

            //ondomready
            $(function () {
                listFilter($());
            });
        }(jQuery));

    </script>


    <script>
        $('.page-header').hover(function () {
            $(this).css("color", '#3875d7')
        }, function () {
            $(this).css('color', '#8B0000')
        })
    </script>




</body>
</html>