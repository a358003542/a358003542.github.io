<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="baidu-site-verification" content="D4VqC4HppC"/>
    <meta name="msvalidate.01" content="55CB117A61A6F8286173763FB18D9625"/>

        <meta name="author" content="cdwanze"/>
        <meta name="copyright" content="cdwanze"/>

        <meta property="og:type" content="article"/>
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="postgresql, database, 数据库, " />

<meta property="og:title" content="postgresql数据库 "/>
<meta property="og:url" content="/articles/postgresql-database.html" />
<meta property="og:description" content="安装和配置 在ubuntu下可以这样简单安装之： sudo apt-get install postgresql centos下如下安装： sudo yum install postgresql-server postgresql-contrib centos下继续运行以下命令： sudo postgresql-setup initdb 这样安装之后，你需要牢记一点的是，新安装的PostgreSQL数据库还只有 postgres 这个用户有新建role（或说用户）和新建数据库的权限。你需要通过 postgres 这个用户来执行 createuser 或 createdb 命令。这里我们先不急着学习SQL语句，因为postgresql里面关于用户群组权限的设置稍微有点复杂，而要使用postgresql，这一块是必须有个基本的了解的。 用户群组权限管理 postgresql处理我们通常所谓的登录用户或者其他用户概念的术语是Rules，后面都称之为用户（rules），可以理解为为这个用户确立的一系列访问修改数据库的规则。然后rules是可以包含其他rules的，这个包含其他rules的rules我们通常称之为群组（group rules），然后群组也可以包含群组，但一般都推荐简单分为用户（rules）和群组用户（group rules）这两类 …" />
<meta property="og:site_name" content="cdwanze的博文" />
<meta property="og:article:author" content="cdwanze" />
<meta property="og:article:published_time" content="2017-11-28T18:00:00+08:00" />
<meta property="" content="2017-12-24T18:00:00+08:00" />
<meta name="twitter:title" content="postgresql数据库 ">
<meta name="twitter:description" content="安装和配置 在ubuntu下可以这样简单安装之： sudo apt-get install postgresql centos下如下安装： sudo yum install postgresql-server postgresql-contrib centos下继续运行以下命令： sudo postgresql-setup initdb 这样安装之后，你需要牢记一点的是，新安装的PostgreSQL数据库还只有 postgres 这个用户有新建role（或说用户）和新建数据库的权限。你需要通过 postgres 这个用户来执行 createuser 或 createdb 命令。这里我们先不急着学习SQL语句，因为postgresql里面关于用户群组权限的设置稍微有点复杂，而要使用postgresql，这一块是必须有个基本的了解的。 用户群组权限管理 postgresql处理我们通常所谓的登录用户或者其他用户概念的术语是Rules，后面都称之为用户（rules），可以理解为为这个用户确立的一系列访问修改数据库的规则。然后rules是可以包含其他rules的，这个包含其他rules的rules我们通常称之为群组（group rules），然后群组也可以包含群组，但一般都推荐简单分为用户（rules）和群组用户（group rules）这两类 …">

    <title>
postgresql数据库  · cdwanze的博文
</title>


        <link href="/theme/css/font-awesome.css" rel="stylesheet"
              media="screen">
        <link href="/theme/css/bootstrap.min.css" rel="stylesheet"
              media="screen">

            <link rel="stylesheet" type="text/css"
                  href="/theme/css/pygments.css" media="screen">
            <link rel="stylesheet" type="text/css"
                  href="/theme/css/elegant.css" media="screen">
            <link rel="stylesheet" type="text/css"
                  href="/theme/css/custom.css" media="screen">






</head>
<body>

<nav class="navbar">
    <div class="navbar navbar-default" role="navigation">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed"
                    data-toggle="collapse" data-target=".navbar-collapse"
                    aria-expanded="false">
                <span class="sr-only">Navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <a class="navbar-brand" href="https://www.cdwanze.work"><span
                    class=site-name>网站首页</span></a>
        </div>


        <div class="navbar-collapse collapse">
            <form action="/search.html"
                  onsubmit="return validateForm(this.elements['q'].value);"
                  class="navbar-form navbar-left">
                <div class="form-group">
                    <input type="text" name="q" id="tipue_search_input"
                           class="form-control" placeholder="Search..."
                           style="width:430px;">
                </div>
                <button class="btn btn-default" type="submit">搜索</button>
            </form>


            <ul class="nav navbar-nav nav-pills navbar-right">
                <li >
                    <a href="">博文首页</a></li>

                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle"
                           data-toggle="dropdown" role="button"
                           aria-haspopup="true" aria-expanded="false">查找文章<span
                                class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a class="slowscroll" href="/categories.html">按分类</a>
                            </li>
                            <li><a class="slowscroll" href="/tags.html">按标签</a>
                            </li>
                        </ul>
                    </li>


                        <li >
                            <a href="/guan-yu-ben-wang-zhan.html">关于本网站</a>
                        </li>
                        <li >
                            <a href="/gong-gao.html">公告</a>
                        </li>
            </ul>


        </div>
    </div>
</nav>


<div class="container-fluid">
    <div class="col-md-1 col-md-1-left"></div>
    <div class="col-md-10">
<article>
<div class="row">
    <header class="page-header col-md-10 col-md-offset-2">
    <h1><a href="/articles/postgresql-database.html"> postgresql数据库  </a></h1>
    </header>
</div>

<div class="row">
    <div class="col-md-2 table-of-content">
        <nav>
        <h4>目录</h4>
        <div class="toc">
<ul>
<li><a href="#_1">安装和配置</a></li>
<li><a href="#_2">用户群组权限管理</a><ul>
<li><a href="#postgres">修改postgres的密码</a></li>
<li><a href="#postgres_1">postgres这个用户</a></li>
<li><a href="#_3">查看当前有多少用户</a></li>
<li><a href="#_4">新建用户</a></li>
<li><a href="#_5">删除用户</a></li>
<li><a href="#_6">改变用户的权限</a></li>
<li><a href="#_7">改变用户密码</a></li>
<li><a href="#_8">新建一个群组</a></li>
<li><a href="#pg_hbaconf">pg_hba.conf</a></li>
</ul>
</li>
<li><a href="#psql">psql</a></li>
<li><a href="#_9">数据库操作基础</a><ul>
<li><a href="#_10">创建数据库</a></li>
<li><a href="#_11">备份和还原</a></li>
<li><a href="#_12">改变某个数据库的所有者</a></li>
<li><a href="#postgresql">postgresql字段数据类型</a></li>
</ul>
</li>
<li><a href="#_13">附录</a><ul>
<li><a href="#_14">配置文件在那里</a></li>
<li><a href="#postgresql_1">重启postgresql服务</a></li>
</ul>
</li>
<li><a href="#_15">参考资料</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="col-md-8 article-content">

            
            
<h2 id="_1">安装和配置</h2>
<p>在ubuntu下可以这样简单安装之：</p>
<div class="highlight"><pre><span></span>sudo  apt-get install postgresql
</pre></div>
<p>centos下如下安装：</p>
<div class="highlight"><pre><span></span>sudo yum install postgresql-server postgresql-contrib
</pre></div>
<p>centos下继续运行以下命令：</p>
<div class="highlight"><pre><span></span>sudo postgresql-setup initdb
</pre></div>
<p>这样安装之后，你需要牢记一点的是，新安装的PostgreSQL数据库还只有 <strong>postgres</strong> 这个用户有新建role（或说用户）和新建数据库的权限。你需要通过 postgres 这个用户来执行 <code>createuser</code> 或 <code>createdb</code> 命令。这里我们先不急着学习SQL语句，因为postgresql里面关于用户群组权限的设置稍微有点复杂，而要使用postgresql，这一块是必须有个基本的了解的。</p>
<h2 id="_2">用户群组权限管理</h2>
<p>postgresql处理我们通常所谓的登录用户或者其他用户概念的术语是Rules，后面都称之为用户（rules），可以理解为为这个用户确立的一系列访问修改数据库的规则。然后rules是可以包含其他rules的，这个包含其他rules的rules我们通常称之为群组（group rules），然后群组也可以包含群组，但一般都推荐简单分为用户（rules）和群组用户（group rules）这两类。然后用户如果有登录权限的话则可以称之为登录用户（login rules），群组用户也可以赋予登录权限，但出于简单的考虑没谁这么做。所以现在rules简单的划分就分为这三类:</p>
<ol>
<li>一般用户，这里主要指没有登录权限的一般用户。</li>
<li>登录用户，或叫做一般登录用户，其属于一般用户，但有登录权限。</li>
<li>群组用户，包含一般用户的rules。</li>
</ol>
<p>此外postgresql还提供 <strong>superuser</strong> 超级用户这一类型，其默认不能登录，但对于数据库几乎拥有所有的权限——比如创建数据库，创建用户，对于数据库的查增删改等。实际上superuser也可以加上 <code>login</code> 属性，但非常不推荐这么做，最好是不使用超级用户，而是对于具体的用户具体的数据库权限进行分配。</p>
<p>默认创建的postgres这个用户是可以连接的，而且我们看到其至少对postgres这个数据库具有所有权限，但是我还不太确定其是不是superuser，因为其可能对其他数据库并没有权限，这个后面再谈。</p>
<h3 id="postgres">修改postgres的密码</h3>
<div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">postgres</span> <span class="n">psql</span> <span class="n">postgres</span>

<span class="n">postgres</span><span class="o">=#</span> <span class="err">\</span><span class="n">password</span> <span class="n">postgres</span>
<span class="n">Enter</span> <span class="k">new</span> <span class="n">password</span><span class="p">:</span> 
<span class="n">Enter</span> <span class="n">it</span> <span class="n">again</span><span class="p">:</span>
</pre></div>
<p>这里需要强调一点的是这里通过psql来进行连接（postgres）然后输入 <code>\password</code> 修改postgres的密码是具体通过 TCP/IP 方式连接postgresql数据库的密码，不是系统passwd管理的那个密码。</p>
<h3 id="postgres_1">postgres这个用户</h3>
<p>postgres这个用户的一些信息如下所示:</p>
<div class="highlight"><pre><span></span><span class="n">postgres</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">121</span><span class="o">:</span><span class="mi">131</span><span class="o">:</span><span class="n">PostgreSQL</span> <span class="n">administrator</span><span class="o">,,,:/</span><span class="n">var</span><span class="sr">/lib/postgresql:/bin/</span><span class="n">bash</span>
</pre></div>
<p>然后还有新建的postgres这个群组:</p>
<div class="highlight"><pre><span></span><span class="n">postgres</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">131</span><span class="o">:</span>
</pre></div>
<p>这里的121是uid，131是gid，然后后面 <code>/var/lib/postgresql</code> 这个文件夹就是postgres该用户的主文件夹，你的关于postgresql的一些配置和数据都放在这里面的。你可能会遇到保存 <code>.psql_history</code> 这个文件的权限问题，参看 <a href="http://dba.stackexchange.com/questions/68705/could-not-save-history-to-file-var-lib-postgresql-psql-history-no-such-file">这个网页</a> ，这个时候需要确认该文件夹的所有用户和所有群组都是postgres。</p>
<h3 id="_3">查看当前有多少用户</h3>
<p>按照 <a href="http://stackoverflow.com/questions/32151288/how-is-there-a-pg-roles-table-in-postgres-before-a-database-is-created">这篇网页</a> 的介绍， <code>pg_roles</code> 是一个view视图，其只是一个对 <code>pg_authid</code> 的简单可读的视图封装，如下面所示，两者目前来说没有差异，然后我们看到postgres其是为superuser，也是login user。</p>
<div class="highlight"><pre><span></span><span class="k">select</span> <span class="n">rolname</span><span class="p">,</span><span class="n">rolsuper</span><span class="p">,</span><span class="n">rolcreaterole</span><span class="p">,</span><span class="n">rolcreatedb</span><span class="p">,</span><span class="n">rolcanlogin</span> <span class="k">from</span> <span class="n">pg_roles</span><span class="p">;</span>
 <span class="n">rolname</span>  <span class="o">|</span> <span class="n">rolsuper</span> <span class="o">|</span> <span class="n">rolcreaterole</span> <span class="o">|</span> <span class="n">rolcreatedb</span> <span class="o">|</span> <span class="n">rolcanlogin</span> 
<span class="c1">----------+----------+---------------+-------------+-------------</span>
 <span class="n">postgres</span> <span class="o">|</span> <span class="n">t</span>        <span class="o">|</span> <span class="n">t</span>             <span class="o">|</span> <span class="n">t</span>           <span class="o">|</span> <span class="n">t</span>
 <span class="n">wanze</span>    <span class="o">|</span> <span class="n">t</span>        <span class="o">|</span> <span class="n">t</span>             <span class="o">|</span> <span class="n">t</span>           <span class="o">|</span> <span class="n">t</span>

<span class="k">select</span> <span class="n">rolname</span><span class="p">,</span><span class="n">rolsuper</span><span class="p">,</span><span class="n">rolcreaterole</span><span class="p">,</span><span class="n">rolcreatedb</span><span class="p">,</span><span class="n">rolcanlogin</span> <span class="k">from</span> <span class="n">pg_authid</span><span class="p">;</span>

 <span class="n">rolname</span>  <span class="o">|</span> <span class="n">rolsuper</span> <span class="o">|</span> <span class="n">rolcreaterole</span> <span class="o">|</span> <span class="n">rolcreatedb</span> <span class="o">|</span> <span class="n">rolcanlogin</span> 
<span class="c1">----------+----------+---------------+-------------+-------------</span>
 <span class="n">postgres</span> <span class="o">|</span> <span class="n">t</span>        <span class="o">|</span> <span class="n">t</span>             <span class="o">|</span> <span class="n">t</span>           <span class="o">|</span> <span class="n">t</span>
 <span class="n">wanze</span>    <span class="o">|</span> <span class="n">t</span>        <span class="o">|</span> <span class="n">t</span>             <span class="o">|</span> <span class="n">t</span>           <span class="o">|</span> <span class="n">t</span>
</pre></div>
<h3 id="_4">新建用户</h3>
<p>新建一个用户:</p>
<div class="highlight"><pre><span></span><span class="k">create</span> <span class="k">role</span> <span class="n">the_name</span><span class="p">;</span>
</pre></div>
<p>但最起码要有登录login权限吧:</p>
<div class="highlight"><pre><span></span><span class="k">create</span> <span class="k">role</span> <span class="n">the_name</span> <span class="n">login</span><span class="p">;</span>
</pre></div>
<p>在使用postgresql时，如果某个用户不存在，那么PostgreSQL将会报错: </p>
<div class="highlight"><pre><span></span><span class="nv">createdb</span>: <span class="nv">could</span> <span class="nv">not</span> <span class="k">connect</span> <span class="nv">to</span> <span class="nv">database</span> <span class="nv">template1</span>: <span class="nv">FATAL</span>:  <span class="nv">role</span> <span class="s2">"</span><span class="s">wanze</span><span class="s2">"</span> <span class="nv">does</span> <span class="nv">not</span> <span class="nv">exist</span>
</pre></div>
<h3 id="_5">删除用户</h3>
<div class="highlight"><pre><span></span><span class="k">drop</span> <span class="k">role</span> <span class="n">the_name</span><span class="p">;</span>
</pre></div>
<p>或者该用户名不存在也不会报错的写法:</p>
<div class="highlight"><pre><span></span><span class="nv">drop</span> <span class="nv">role</span> <span class="k">if</span> <span class="nv">exists</span> <span class="nv">the_name</span><span class="c1">;</span>
</pre></div>
<h3 id="_6">改变用户的权限</h3>
<p>如下所示就改变一个用户的权限了。</p>
<div class="highlight"><pre><span></span><span class="k">alter</span> <span class="k">role</span> <span class="n">the_name</span> <span class="k">createdb</span><span class="p">;</span>
</pre></div>
<p>参照手册，后面的关键词有:</p>
<div class="highlight"><pre><span></span><span class="n">SUPERUSER</span> <span class="o">|</span> <span class="n">NOSUPERUSER</span>
<span class="k">CREATEDB</span> <span class="o">|</span> <span class="k">NOCREATEDB</span>
<span class="n">CREATEROLE</span> <span class="o">|</span> <span class="n">NOCREATEROLE</span>
<span class="k">CREATEUSER</span> <span class="o">|</span> <span class="k">NOCREATEUSER</span>
<span class="n">INHERIT</span> <span class="o">|</span> <span class="n">NOINHERIT</span>
<span class="n">LOGIN</span> <span class="o">|</span> <span class="n">NOLOGIN</span>
<span class="n">REPLICATION</span> <span class="o">|</span> <span class="n">NOREPLICATION</span>
</pre></div>
<h3 id="_7">改变用户密码</h3>
<p>在新建用户的时候，我们可以如下:</p>
<div class="highlight"><pre><span></span><span class="k">create</span> <span class="k">role</span> <span class="n">the_name</span> <span class="n">password</span> <span class="ss">"the_password"</span><span class="p">;</span>
</pre></div>
<p>后面也可以通过 <code>alter role</code> 来:</p>
<div class="highlight"><pre><span></span><span class="k">alter</span> <span class="k">role</span> <span class="n">the_name</span> <span class="n">password</span> <span class="ss">"the_password"</span><span class="p">;</span>
</pre></div>
<h3 id="_8">新建一个群组</h3>
<div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">ROLE</span> <span class="n">royalty</span> <span class="n">INHERIT</span><span class="p">;</span>
</pre></div>
<p>给群组用户增加登录用户</p>
<div class="highlight"><pre><span></span><span class="k">GRANT</span> <span class="n">royalty</span> <span class="k">TO</span> <span class="n">leo</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="n">royalty</span> <span class="k">TO</span> <span class="n">regina</span><span class="p">;</span>
</pre></div>
<h3 id="pg_hbaconf">pg_hba.conf</h3>
<p>很多连接问题就是因为这个文件没有配置好，下面详细研究这个文件之。</p>
<div class="highlight"><pre><span></span><span class="err">#</span><span class="w"></span>
<span class="err">#</span><span class="w"> </span><span class="k">local</span><span class="w">      </span><span class="k">DATABASE</span><span class="w">  </span><span class="k">USER</span><span class="w">  </span><span class="k">METHOD</span><span class="w">  </span><span class="o">[</span><span class="n">OPTIONS</span><span class="o">]</span><span class="w"></span>
<span class="err">#</span><span class="w"> </span><span class="k">host</span><span class="w">       </span><span class="k">DATABASE</span><span class="w">  </span><span class="k">USER</span><span class="w">  </span><span class="n">ADDRESS</span><span class="w">  </span><span class="k">METHOD</span><span class="w">  </span><span class="o">[</span><span class="n">OPTIONS</span><span class="o">]</span><span class="w"></span>
<span class="err">#</span><span class="w"> </span><span class="n">hostssl</span><span class="w">    </span><span class="k">DATABASE</span><span class="w">  </span><span class="k">USER</span><span class="w">  </span><span class="n">ADDRESS</span><span class="w">  </span><span class="k">METHOD</span><span class="w">  </span><span class="o">[</span><span class="n">OPTIONS</span><span class="o">]</span><span class="w"></span>
<span class="err">#</span><span class="w"> </span><span class="n">hostnossl</span><span class="w">  </span><span class="k">DATABASE</span><span class="w">  </span><span class="k">USER</span><span class="w">  </span><span class="n">ADDRESS</span><span class="w">  </span><span class="k">METHOD</span><span class="w">  </span><span class="o">[</span><span class="n">OPTIONS</span><span class="o">]</span><span class="w"></span>
</pre></div>
<ul>
<li>
<p>local 是指本地连接</p>
</li>
<li>
<p>host 是指plain或者ssl加密的TCP套接字连接（一般指http和https）</p>
</li>
<li>
<p>hostssl 是指ssl加密的TCP套接字连接</p>
</li>
<li>
<p>hostnossl 是指plain 简单的TCP套接字连接</p>
</li>
<li>
<p>DATABASE 设置要连接的数据库，常见的all</p>
</li>
<li>
<p>ADDRESS 有 127.0.0.1/32 也就是本地连接ipv4，或者 0.0.0.0/0 指所有的ipv4外网。这是一种网域段表示法。</p>
</li>
<li>
<p>METHOD 有trust，reject，md5（加密的密钥），password（明文密钥）
    让人困惑的peer方法查阅文档解释如下：</p>
<blockquote>
<p>The peer authentication method works by obtaining the client's operating system user name from the kernel and using it as the allowed database user name (with optional user name mapping). This method is only supported on local connections.</p>
<p>peer认证方法获取客服端操作系统的用户名，然后将其作为允许数据库的用户名。这个方法只适用于local连接。</p>
</blockquote>
</li>
</ul>
<p>ident方法如果是本地连接的话就会使用peer方法，官方文档在解释上字面也很相同，区别就在 <code>an ident server</code> ,一个是from kernel， 一个是from ident server， 这个暂时不懂？</p>
<h2 id="psql">psql</h2>
<p>这里参考了 <a href="http://dba.stackexchange.com/questions/1285/how-do-i-list-all-databases-and-tables-using-psql">这个网页</a> 。</p>
<ul>
<li><strong><code>\l</code> 或 <code>\list</code>:</strong> 列出所有的数据库</li>
<li><strong><code>\du</code>:</strong> 列出所有的用户</li>
<li><strong><code>\dt *</code>:</strong> 列出当前数据库所有的表格</li>
<li><strong><code>\c</code> 或者 <code>\connect</code>:</strong> 切换数据库</li>
</ul>
<h2 id="_9">数据库操作基础</h2>
<h3 id="_10">创建数据库</h3>
<div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">mydb</span><span class="p">;</span>
</pre></div>
<p>有 CREATEDB 权限的用户可以新建数据库。</p>
<p>然后创建一个数据库，并指定这个数据库的owner。</p>
<div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">mydb</span> <span class="k">WITH</span> <span class="k">owner</span> <span class="o">=</span> <span class="n">mydb_admin</span><span class="p">;</span>
</pre></div>
<p>然后以mydb_admin登录开始进行数据库的其他操作。</p>
<h3 id="_11">备份和还原</h3>
<p>两个backup方法  pg_dump 和 pg_dumpall
用pg_restore 来还原，</p>
<h3 id="_12">改变某个数据库的所有者</h3>
<p>首先你需要以postgres的身份连接postgres数据库，因为你要进行更改某个数据库的所有者，就必须是目前该数据库的所有者。</p>
<div class="highlight"><pre><span></span><span class="nv">wanze</span>@<span class="nv">wanze</span><span class="o">-</span><span class="nv">ubuntu</span>:<span class="o">~</span>$ <span class="nv">sudo</span> <span class="o">-</span><span class="nv">u</span> <span class="nv">postgres</span> <span class="nv">psql</span> <span class="nv">postgres</span>
<span class="nv">psql</span> <span class="ss">(</span><span class="mi">9</span>.<span class="mi">3</span>.<span class="mi">8</span><span class="ss">)</span>
<span class="nv">Type</span> <span class="s2">"</span><span class="s">help</span><span class="s2">"</span> <span class="k">for</span> <span class="nv">help</span>.

<span class="nv">postgres</span><span class="o">=</span># <span class="nv">ALTER</span> <span class="nv">DATABASE</span> <span class="nv">mydb</span> <span class="nv">OWNER</span> <span class="nv">TO</span> <span class="nv">learner</span><span class="c1">;</span>
<span class="nv">ALTER</span> <span class="nv">DATABASE</span>
<span class="nv">postgres</span><span class="o">=</span># \<span class="nv">q</span>
</pre></div>
<p>这里ALTER DATABASE语句里面 mydb 是具体你要更改的数据库名字，然后后面的learner是具体更改为的所有者名字。</p>
<p>类似上面谈及的，还有 <strong>dropdb</strong> 用于删除数据库， <strong>dropuser</strong> 用于删除用户。</p>
<p>CREATE TABLE语句我们都熟悉了，不过具体到数据类型上，还需要详细讨论一番。</p>
<h3 id="postgresql">postgresql字段数据类型</h3>
<p>int , smallint , real , double precision ,
char( N ) , varchar( N ) , date , time , timestamp , and interval ,</p>
<p>而postgresql支持的数据类型就多了，有：int，smallint，real，boolean，date，time，integer，text，char(N)，varchar(N) 甚至还有json。这个可以后面慢慢了解，更多细节请具体参看官方文档第八章 Data Types，这是 <a href="http://www.postgresql.org/docs/9.3/static/datatype.html">版本9.3的网页链接</a> 。</p>
<p>其中对于整数简单的就用integer，字符串简单的就用text，然后小数简单的就用real，布尔值就用boolean，此外还有一些特殊用途的数据类型值得引起我们的注意，如uuid，json，arrays，money，bytea，还有日期和时间的date，time；几何类型支持的point，line等等</p>
<h2 id="_13">附录</h2>
<h3 id="_14">配置文件在那里</h3>
<div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">postgres</span> <span class="n">psql</span> <span class="n">postgres</span>

<span class="n">psql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span><span class="n">setting</span> <span class="k">FROM</span> <span class="n">pg_settings</span> <span class="k">WHERE</span> <span class="n">category</span> <span class="o">=</span> <span class="s1">'File Locations'</span><span class="p">;</span>
       <span class="n">name</span>        <span class="o">|</span>                 <span class="n">setting</span>                  
<span class="c1">-------------------+------------------------------------------</span>
 <span class="n">config_file</span>       <span class="o">|</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">postgresql</span><span class="o">/</span><span class="mi">9</span><span class="p">.</span><span class="mi">3</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">postgresql</span><span class="p">.</span><span class="n">conf</span>
 <span class="n">data_directory</span>    <span class="o">|</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">postgresql</span><span class="o">/</span><span class="mi">9</span><span class="p">.</span><span class="mi">3</span><span class="o">/</span><span class="n">main</span>
 <span class="n">external_pid_file</span> <span class="o">|</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">postgresql</span><span class="o">/</span><span class="mi">9</span><span class="p">.</span><span class="mi">3</span><span class="o">-</span><span class="n">main</span><span class="p">.</span><span class="n">pid</span>
 <span class="n">hba_file</span>          <span class="o">|</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">postgresql</span><span class="o">/</span><span class="mi">9</span><span class="p">.</span><span class="mi">3</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">pg_hba</span><span class="p">.</span><span class="n">conf</span>
 <span class="n">ident_file</span>        <span class="o">|</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">postgresql</span><span class="o">/</span><span class="mi">9</span><span class="p">.</span><span class="mi">3</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">pg_ident</span><span class="p">.</span><span class="n">conf</span>
<span class="p">(</span><span class="mi">5</span> <span class="k">rows</span><span class="p">)</span>
</pre></div>
<h3 id="postgresql_1">重启postgresql服务</h3>
<p>在linux下可以运行如下命令行来达到目的:</p>
<div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">postgresql</span> <span class="k">restart</span>
</pre></div>
<p>或者</p>
<div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">postgresql</span> <span class="n">reload</span>
</pre></div>
<h2 id="_15">参考资料</h2>
<ol>
<li>PostgreSQL官方参考文档</li>
<li>PostgreSQL Up and Running, 2nd Edition</li>
</ol>
            
            
            <hr/>

        </div>
        <section>
        <div class="col-md-2" style="float:right;font-size:0.9em;">
            <h4>首发于：</h4>
            <time pubdate="pubdate" datetime="2017-11-28T18:00:00+08:00">2017年 11月 28日 </time>

<h4>最近更新于：</h4>
<time datetime="2017-12-24T18:00:00+08:00">2017年 12月 24日 </time>

            <h4>分类：</h4>
            <a class="category-link" href="/categories.html#shu-ju-ku-ref">数据库</a>
            <h4>标签：</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="/tags.html#database-ref">database
                    <span>3</span>
</a></li>
                <li><a href="/tags.html#postgresql-ref">postgresql
                    <span>1</span>
</a></li>
            </ul>
        </div>
        </section>
</div>
</article>
    </div>
    <div class="col-md-1"></div>

</div>


<div id="push"></div>


<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a> and updated by <a href="http://www.cdwanze.work" title="cdwanze Home Page">cdwanze</a></li>
    </ul>
</div>
</footer>

        <script src="/theme/js/jquery.min.js"></script>
    <script src="/theme/js/bootstrap.min.js"></script>
    <script>
        function validateForm(query) {
            return (query.length > 0);
        }
    </script>

    <script>
        function adjust_search_width() {
            var w = document.documentElement.clientWidth;
            if ((w > 755) && (w < 975)) {
                plus_width = w - 755;
                $('.navbar-form .form-control').outerWidth(210 + plus_width);
            } else if (w >= 975) {
                $('.navbar-form .form-control').outerWidth(210 + 220);
            } else if (w <= 755) {
                $('.navbar-form .form-control').css('width', '100%')
            }
        }

        $(document).ready(function () {
            adjust_search_width();
        });

        window.onresize = function () {
            adjust_search_width();
        }

    </script>


    



</body>
</html>