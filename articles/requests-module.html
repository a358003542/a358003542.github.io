<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="msvalidate.01" content="55CB117A61A6F8286173763FB18D9625"/>

        <meta name="author" content="wanze"/>
        <meta name="copyright" content="wanze"/>

        <meta name="description"
              content="urllib.request内置模块 urllib.request模块我们可以在这里稍微了解一下，但一般实际使用主要是用后面要介绍的 requests 模块。 urlopen函数 urlopen函数在urllib模块的request子模块，其提供了简单的获取目标url网页内容的接口。一个简单的例子如下所示： from urllib.request import urlopen import socket socket.setdefaulttimeout(10) urls = [&#39;https://www.google.com.cn&#39;,&#39;https://www.google.com&#39;, &#39;http://www.google.com.cn&#39;] for url in urls: try: response = urlopen(url) html = response.read().decode(&#39;utf-8&#39;) print …
"/>

        <meta property="og:type" content="article"/>
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="python, python_companion, " />

<meta property="og:title" content="requests模块 "/>
<meta property="og:url" content="https://a358003542.github.io/articles/requests-module.html" />
<meta property="og:description" content="urllib.request内置模块 urllib.request模块我们可以在这里稍微了解一下，但一般实际使用主要是用后面要介绍的 requests 模块。 urlopen函数 urlopen函数在urllib模块的request子模块，其提供了简单的获取目标url网页内容的接口。一个简单的例子如下所示： from urllib.request import urlopen import socket socket.setdefaulttimeout(10) urls = [&#39;https://www.google.com.cn&#39;,&#39;https://www.google.com&#39;, &#39;http://www.google.com.cn&#39;] for url in urls: try: response = urlopen(url) html = response.read().decode(&#39;utf-8&#39;) print …" />
<meta property="og:site_name" content="万泽的博客" />
<meta property="og:article:author" content="wanze" />
<meta property="og:article:published_time" content="2019-09-09T00:00:00+08:00" />
<meta name="twitter:title" content="requests模块 ">
<meta name="twitter:description" content="urllib.request内置模块 urllib.request模块我们可以在这里稍微了解一下，但一般实际使用主要是用后面要介绍的 requests 模块。 urlopen函数 urlopen函数在urllib模块的request子模块，其提供了简单的获取目标url网页内容的接口。一个简单的例子如下所示： from urllib.request import urlopen import socket socket.setdefaulttimeout(10) urls = [&#39;https://www.google.com.cn&#39;,&#39;https://www.google.com&#39;, &#39;http://www.google.com.cn&#39;] for url in urls: try: response = urlopen(url) html = response.read().decode(&#39;utf-8&#39;) print …">


    <title>requests模块  · 万泽的博客
</title>

        <link href="https://a358003542.github.io/theme/css/font-awesome.css" rel="stylesheet"
              media="screen">
        <link href="https://a358003542.github.io/theme/css/bootstrap.min.css" rel="stylesheet"
              media="screen">

        <link rel="stylesheet" type="text/css"
                  href="https://a358003542.github.io/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css"
                  href="https://a358003542.github.io/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css"
                  href="https://a358003542.github.io/theme/css/base.css" media="screen">




</head>
<body>

<nav class="navbar">
    <div class="navbar navbar-default" role="navigation">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed"
                    data-toggle="collapse" data-target=".navbar-collapse"
                    aria-expanded="false">
                <span class="sr-only">Navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <a class="navbar-brand" href="https://a358003542.github.io/"><span
                    class=site-name>网站首页</span></a>
        </div>


        <div class="navbar-collapse collapse">
            <form action="https://a358003542.github.io/search.html"
                  onsubmit="return validateForm(this.elements['q'].value);"
                  class="navbar-form navbar-left">
                <div class="form-group">
                    <input type="text" name="q" id="tipue_search_input"
                           class="form-control" placeholder="Search..."
                           style="width:430px;">
                </div>
                <button class="btn btn-default" type="submit">搜索</button>
            </form>


            <ul class="nav navbar-nav nav-pills navbar-right">
                <li >
                    <a  href="/archives.html">所有文章</a></li>

                <li ><a href="/categories.html">文章分类</a></li>
                <li ><a href="/tags.html">文章标签</a></li>


                        <li >
                            <a href="https://a358003542.github.io/about.html">关于本网站</a>
                        </li>
            </ul>


        </div>
    </div>
</nav>


<div class="container-fluid">
    <div class="col-md-1 col-md-1-left"></div>
    <div class="col-md-10">
<article>
<div class="row">
    <header class="page-header col-md-10 col-md-offset-2">
    <h1><a href="https://a358003542.github.io/articles/requests-module.html"> requests模块  </a></h1>
    </header>
</div>

<div class="row">
    <div class="col-md-2 table-of-content">
        <nav>
        <h4>目录</h4>
        <div class="toc">
<ul>
<li><a href="#urllibrequest">urllib.request内置模块</a><ul>
<li><a href="#urlopen">urlopen函数</a><ul>
<li><a href="#_1">返回的是什么</a></li>
<li><a href="#httperrorurlerror">HTTPError和URLError异常</a></li>
<li><a href="#contenttooshorterror">ContentTooShortError异常</a></li>
</ul>
</li>
<li><a href="#401-error">访问网页得到401 error</a><ul>
<li><a href="#_2">加上代理功能来翻墙</a></li>
</ul>
</li>
<li><a href="#urlget">通过修改url来GET数据</a></li>
<li><a href="#post">通过POST方法来获取数据</a></li>
</ul>
</li>
<li><a href="#requests">requests模块基础</a><ul>
<li><a href="#_3">安装</a></li>
<li><a href="#http">HTTP基本协议支持</a><ul>
<li><a href="#get">get函数</a><ul>
<li><a href="#params">params参数</a></li>
</ul>
</li>
<li><a href="#post_1">post函数</a><ul>
<li><a href="#data">data参数</a></li>
<li><a href="#headers">headers属性</a></li>
</ul>
</li>
<li><a href="#put">put函数</a></li>
<li><a href="#delete">delete函数</a></li>
</ul>
</li>
<li><a href="#reponse">返回的reponse响应对象</a><ul>
<li><a href="#url">url属性</a></li>
<li><a href="#text">text属性</a></li>
<li><a href="#encoding">encoding属性</a></li>
<li><a href="#content">content属性</a></li>
<li><a href="#json">json方法</a></li>
<li><a href="#status95code">status_code属性</a></li>
<li><a href="#headers_1">headers方法</a></li>
<li><a href="#allow95redirects">allow_redirects</a></li>
<li><a href="#timeout">timeout参数</a></li>
</ul>
</li>
<li><a href="#_4">异常</a></li>
</ul>
</li>
<li><a href="#requests_1">requests模块高级篇</a><ul>
<li><a href="#_5">会话</a></li>
<li><a href="#ssl">SSL验证</a></li>
<li><a href="#content_1">响应体的content</a><ul>
<li><a href="#responseiter95content">response.iter_content</a></li>
<li><a href="#responseiter95lines">response.iter_lines</a></li>
</ul>
</li>
<li><a href="#_6">身份验证</a></li>
<li><a href="#_7">代理</a></li>
</ul>
</li>
<li><a href="#_8">附录</a><ul>
<li><a href="#http_1">关于HTTP的补充理论知识</a><ul>
<li><a href="#getpost">GET和POST的区别</a></li>
<li><a href="#http_2">HTTP返回错误码含义</a></li>
</ul>
</li>
<li><a href="#_9">参考资料</a></li>
</ul>
</li>
</ul>
</div>
        </nav>
    </div>
    <div class="col-md-8 article-content">

            
<h1 id="urllibrequest">urllib.request内置模块</h1>
<p>urllib.request模块我们可以在这里稍微了解一下，但一般实际使用主要是用后面要介绍的 <strong>requests</strong> 模块。</p>
<h2 id="urlopen">urlopen函数</h2>
<p>urlopen函数在urllib模块的request子模块，其提供了简单的获取目标url网页内容的接口。一个简单的例子如下所示：</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="n">socket</span><span class="o">.</span><span class="n">setdefaulttimeout</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'https://www.google.com.cn'</span><span class="p">,</span><span class="s1">'https://www.google.com'</span><span class="p">,</span>
    <span class="s1">'http://www.google.com.cn'</span><span class="p">]</span>

<span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">timeout</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</pre></div>
<p>为什么刚开始就用这么一个稍显复杂的例子作为演示，well，天朝网络的特色。如果你用百度的url <code>http://www.baidu.com</code> ，可能大部分情况下你都不用操心这些问题，但既然我们处在天朝网络这个大背景下，还是早点介绍这个。这个例子的返回的error种类似乎间接地反映了GFW的工作原理。</p>
<p>比如google的.com.cn的https连接还能正常工作（目前暂时。。），只是有时会有点慢，然后其http连接则会返回404错误，这是天朝网络常见的网络错误了，大家的分析是GFW进行了dns投毒。而对于google的.com连接不管是http或者https连接都会返回OSError错误，说的是：Network is unreachable，这表明GFW对于后缀google.com的url采取的完全硬件级别的网络掐断。</p>
<p>然后urlopen函数第一个参数是url连接这不用多说，其还有很多可选项，其中很重要的参数就是 <strong>timeout</strong> 参数，这个和socket套接字的工作模式相关。如果不加上这个timeout参数，对于某些被墙的网站就会一直尝试然后程序陷入卡死状态了。在后面会介绍 <strong>urlretrieve</strong> 函数，也在这个urllib.request模块下面，这个函数可以用于网络下载东西，其并没有内置的timeout参数，不过可以通过设置全局网络socket的timeout（前面socket模块的setdefaulttimeout函数），这个全局timeout最好设置得稍微大一点。</p>
<p>这里的套接字socket的timeout参数就是控制阻塞时间的，因为有些网络数据不可能一次就传递完，好比下载过程一样的有个时间，而这个timeout就是控制这个下载时间的，如果超过这个时间了那么直接返回错误。这里有个问题，就是这个程序默认全局socket的timeout都设置为10秒，那么会不会以后用urlretrieve函数下载某个东西，本身就要求超过10秒？参看requests文档的 <a href="http://cn.python-requests.org/zh_CN/latest/user/quickstart.html#id10">这里</a> ，其对timeout有很好的解释，他说timeout仅对连接过程有效，与响应体的下载无关。</p>
<p>因为网络上的情况比较复杂，关于网络的这些异常处理是不可回避的话题。上面虽然只是一个简单读取网页的程序也跟上了这么多异常捕捉，不是为了偏执的追求程序的健壮，而是必要的必须做的工作。</p>
<h3 id="_1">返回的是什么</h3>
<p>urlopen函数返回的是urllib.response模块的Response对象，其提供了一些简单的文件风格的操作接口，比如 <code>read()</code> 方法， <code>readline()</code> 方法，需要记住的是read之后返回的是 <strong>bytes流</strong> 。</p>
<p>这个Response对象还有 <code>geturl()</code> 方法，其返回具体的url字符串，还有 <code>info()</code> 方法，其返回一个字典值，里面有一些关于网页的基本信息。这个请读者自己试验一下。</p>
<h3 id="httperrorurlerror">HTTPError和URLError异常</h3>
<div class="highlight"><pre><span></span>from urllib.error import HTTPError
</pre></div>
<p>HTTPError是URLError的子类，URLError是OSError的子类，而OSError是不要加载模块就可以直接引用的，所以简单的处理就用OSError来捕捉。</p>
<h3 id="contenttooshorterror">ContentTooShortError异常</h3>
<div class="highlight"><pre><span></span>from urllib.error import ContentTooShortError
</pre></div>
<p>当 <strong>urlretrieve</strong> 函数下载的数据量少于预期的数据量时返回这个错误。</p>
<h2 id="401-error">访问网页得到401 error</h2>
<p>这里以路由器为例 <code>192.168.1.1</code> 或者 <code>192.168.0.1</code> 等，上面的小脚本我们稍作修改有：</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
<span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">HTTPError</span>

<span class="kn">import</span> <span class="nn">socket</span>
<span class="n">socket</span><span class="o">.</span><span class="n">setdefaulttimeout</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>


<span class="n">url</span> <span class="o">=</span> <span class="s1">'http://192.168.1.1'</span>


<span class="k">try</span><span class="p">:</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
<span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">timeout</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
<span class="k">except</span> <span class="n">HTTPError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">error</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="s1">' need password, the 401 error'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">error</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
</pre></div>
<p>运行会返回：</p>
<div class="highlight"><pre><span></span>http://192.168.1.1  need password, the 401 error
</pre></div>
<p>返回了401异常，那么这个网页需要经过网页认证才能访问。下面是一个简单的小脚本附带网页认证功能：</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">build_opener</span><span class="p">,</span> <span class="n">HTTPBasicAuthHandler</span><span class="p">,</span> <span class="n">urlopen</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">HTTPError</span>
<span class="kn">import</span> <span class="nn">getpass</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="n">socket</span><span class="o">.</span><span class="n">setdefaulttimeout</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>


<span class="n">url</span> <span class="o">=</span> <span class="s1">'http://192.168.1.1'</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">username</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">"Username:"</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'try...'</span><span class="p">,</span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="p">)</span>

    <span class="n">auth_handler</span> <span class="o">=</span> <span class="n">HTTPBasicAuthHandler</span><span class="p">()</span>
    <span class="n">auth_handler</span><span class="o">.</span><span class="n">add_password</span><span class="p">(</span><span class="n">realm</span> <span class="o">=</span> <span class="s1">''</span><span class="p">,</span><span class="n">uri</span> <span class="o">=</span> <span class="s1">''</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="n">username</span><span class="p">,</span><span class="n">passwd</span> <span class="o">=</span> <span class="n">password</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">opener</span> <span class="o">=</span> <span class="n">build_opener</span><span class="p">(</span><span class="n">auth_handler</span><span class="p">)</span>
        <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">install_opener</span><span class="p">(</span><span class="n">opener</span><span class="p">)</span>
        <span class="c1">###install it gloably so urlopen can use it</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'I found it'</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">timeout</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">HTTPError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">error</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="s1">' need password, the 401 error'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">error</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
</pre></div>
<p>这里的getpass内置模块的getpass函数提供了终端输入密码不显示的功能。然后我们看到 <code>build_opener()</code> 这个函数，其可以接受一系列的handler，根据 <code>HTTPBasicAuthHandler</code> 创建了一个handler实例，其通过 <code>add_password</code> 方法来加入用户名和密码属性，其中realm和uri我还不清楚。似乎通过你要认证的网页head可以看到。</p>
<p>然后调用urllib子模块request的 <code>install_opener</code> 函数，其将全局性的安装这个openr，后面的urlopen函数就会使用这个opener了。如果不这样做，则需要使用opener.open单独打开一个response，这并不推荐。</p>
<h3 id="_2">加上代理功能来翻墙</h3>
<p>现在我们修改最初的那个第一个例子，加入代理功能，从理论上这样写似乎应该可以了，但是并没有效果，GFW还是很强大地。。</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span><span class="p">,</span> <span class="n">build_opener</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="n">socket</span><span class="o">.</span><span class="n">setdefaulttimeout</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'https://www.google.com.cn'</span><span class="p">,</span><span class="s1">'https://www.google.com'</span><span class="p">,</span>
    <span class="s1">'http://www.google.com.cn'</span><span class="p">]</span>

<span class="n">proxy_handler</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">ProxyHandler</span><span class="p">({</span><span class="s1">'http'</span><span class="p">:</span><span class="s1">'http://127.0.0.1:8580/'</span><span class="p">})</span>
<span class="n">opener</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">build_opener</span><span class="p">(</span><span class="n">proxy_handler</span><span class="p">)</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">install_opener</span><span class="p">(</span><span class="n">opener</span><span class="p">)</span>

<span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">timeout</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</pre></div>
<h2 id="urlget">通过修改url来GET数据</h2>
<p>下面开始对接各个搜索引擎。</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="n">socket</span><span class="o">.</span><span class="n">setdefaulttimeout</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1">#search_engine = 'http://www.baidu.com/'</span>
<span class="c1">#search_engine = 'http://www.zhihu.com/'</span>

<span class="n">search_engine</span> <span class="o">=</span> <span class="s1">'http://stackoverflow.com/'</span>

<span class="k">def</span> <span class="nf">addGETdata</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">netloc</span> <span class="o">==</span> <span class="s1">'www.baidu.com'</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">url</span> <span class="o">+</span> <span class="s1">'s?'</span> <span class="o">+</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">({</span><span class="s1">'wd'</span><span class="p">:</span><span class="n">string</span><span class="p">})</span>
    <span class="k">elif</span> <span class="n">p</span><span class="o">.</span><span class="n">netloc</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'www.zhihu.com'</span><span class="p">,</span><span class="s1">'stackoverflow.com'</span><span class="p">]:</span>
        <span class="k">return</span>  <span class="n">url</span> <span class="o">+</span> <span class="s1">'search?'</span> <span class="o">+</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">({</span><span class="s1">'q'</span><span class="p">:</span><span class="n">string</span><span class="p">})</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">addGETdata</span><span class="p">(</span><span class="n">search_engine</span><span class="p">,</span> <span class="s1">'python urllib'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="n">pyout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'test.html'</span><span class="p">,</span><span class="s1">'w'</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">html</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">pyout</span><span class="p">)</span>
<span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">timeout</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</pre></div>
<p>这里主要要讲的是addGETdata这个函数，其修改url为目标形式，然后后面都是一样的，这个要根据具体目标搜索引擎网站来了。</p>
<h2 id="post">通过POST方法来获取数据</h2>
<p>这个不太灵活，我们看到前面baidu和zhihu两个并不相同，而如果采用POST方法，默认是加入的中缀search?，这有时不太适合，其次采用POST方法需要给自己伪装头部，否则有些网站会禁止你。这个方法略过了。就直接通过修改url来GET已经很简单了。</p>
<h1 id="requests">requests模块基础</h1>
<p>具体网络编程推荐使用requests模块，这是requests的 <a href="http://docs.python-requests.org/en/latest/">官网</a> ，这是中文文档的 <a href="http://cn.python-requests.org/zh_CN/latest/">链接</a> 。更多信息请参看官方文档。</p>
<h2 id="_3">安装</h2>
<p>安装推荐使用pip或者pip3命令简便安装之。</p>
<h2 id="http">HTTP基本协议支持</h2>
<p>下面这几个函数一看名字就知道对应的是HTTP的GET，POST，PUT和DELETE方法，然后HTTP的冷门方法HEAD和OPTIONS requests模块有类似的head函数和options函数。</p>
<h3 id="get">get函数</h3>
<p>这是之前第一个例子的改写：</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'https://www.google.com.cn'</span><span class="p">,</span><span class="s1">'https://www.google.com'</span><span class="p">,</span>
    <span class="s1">'http://www.google.com.cn'</span><span class="p">]</span>

<span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
</pre></div>
<p>这里使用get函数对应HTTP的GET方法来获取网页的内容，然后注意现在 <span class="underline">不能通过socket全局设置timeout了</span> ，而需要设置一个timeout参数。提取文本内容简单的调用text属性即可，后面是一些错误捕捉，这里就不赘述了。</p>
<h4 id="params">params参数</h4>
<p>params参数就是给url加入一些关键词和值等，带点前面提及的urlencode函数的功能，但整个语句更加简洁方便了。下面通过类似前面的例子来演示之：</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">urllib</span><span class="c1">###use the urlparse</span>

<span class="n">search_engines</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">'http://www.baidu.com/s'</span><span class="p">,</span>
    <span class="s1">'http://www.zhihu.com/search'</span><span class="p">,</span>
    <span class="s1">'http://stackoverflow.com/search'</span><span class="p">,</span>
    <span class="s1">'http://www.ask.com/web'</span><span class="p">,</span>
    <span class="s1">'http://search.yahoo.com/search'</span><span class="p">,</span>
    <span class="s1">'http://cn.bing.com/search'</span><span class="p">,</span>
    <span class="s1">'https://www.google.com/#'</span><span class="p">,</span>
    <span class="s1">'https://zh.wikipedia.org/w/index.php'</span><span class="p">,</span>
    <span class="s1">'https://en.wikipedia.org/wiki/'</span><span class="p">,</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">addGETparams</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">search_string</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">netloc</span> <span class="o">==</span> <span class="s1">'www.baidu.com'</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">'wd'</span><span class="p">:</span><span class="n">search_string</span><span class="p">}</span>
    <span class="k">elif</span> <span class="n">p</span><span class="o">.</span><span class="n">netloc</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'www.zhihu.com'</span><span class="p">,</span><span class="s1">'stackoverflow.com'</span><span class="p">,</span><span class="s1">'cn.bing.com'</span><span class="p">,</span>
        <span class="s1">'www.ask.com'</span><span class="p">,</span><span class="s1">'www.google.com'</span><span class="p">]:</span>
        <span class="k">return</span>  <span class="p">{</span><span class="s1">'q'</span><span class="p">:</span><span class="n">search_string</span><span class="p">}</span>
    <span class="k">elif</span> <span class="n">p</span><span class="o">.</span><span class="n">netloc</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'search.yahoo.com'</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">'p'</span><span class="p">:</span><span class="n">search_string</span><span class="p">}</span>
    <span class="k">elif</span> <span class="n">p</span><span class="o">.</span><span class="n">netloc</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'zh.wikipedia.org'</span><span class="p">,</span><span class="s1">'en.wikipedia.org'</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">'search'</span><span class="p">:</span><span class="n">search_string</span><span class="p">}</span>

<span class="n">search_engine</span> <span class="o">=</span> <span class="n">search_engines</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">addGETparams</span><span class="p">(</span><span class="n">search_engine</span><span class="p">,</span> <span class="s1">'python'</span><span class="p">)</span>

<span class="n">pyout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'test.html'</span><span class="p">,</span><span class="s1">'w'</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">search_engine</span><span class="p">,</span> <span class="n">timeout</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">pyout</span><span class="p">)</span>
<span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
<span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>

<span class="n">pyout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
<p>其中search_engin的原始url做了一些修改，使得语法更加的简洁了。</p>
<h3 id="post_1">post函数</h3>
<p>和get函数一样如下使用：</p>
<div class="highlight"><pre><span></span>response = requests.put("http://httpbin.org/put")
</pre></div>
<h4 id="data">data参数</h4>
<p>data参数，就是POST方法实际传输过去的数据，可以是字符串，字典值，或者json数据（需要用json模块的dumps函数处理之）。</p>
<div class="highlight"><pre><span></span>&gt;&gt;&gt; payload = {'key1': 'value1', 'key2': 'value2'}
&gt;&gt;&gt; r = requests.post("http://httpbin.org/post", data=payload)
</pre></div>
<h4 id="headers">headers属性</h4>
<p>接受一个字典值，用于定制POST方法的HTTP请求头。</p>
<h3 id="put">put函数</h3>
<p>暂时略过。</p>
<h3 id="delete">delete函数</h3>
<p>暂时略过。</p>
<h2 id="reponse">返回的reponse响应对象</h2>
<p>上面这些函数返回的reponse对象</p>
<h3 id="url">url属性</h3>
<p>返回响应具体的url</p>
<h3 id="text">text属性</h3>
<p>返回响应的文本内容</p>
<h3 id="encoding">encoding属性</h3>
<p>返回响应的encoding。</p>
<h3 id="content">content属性</h3>
<p>返回的是响应的二进制形式。我们可以利用这个属性来下载文件。下面这个 <code>download_file</code> 函数参考了 <a href="http://stackoverflow.com/questions/16694907/how-to-download-large-file-in-python-with-requests-py">这个网页</a> 。</p>
<p>注意这里用了 <code>stream = True</code> 参数设置，然后</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">filefold</span><span class="o">=</span><span class="s1">'download'</span><span class="p">):</span>
    <span class="sd">'''简单的根据url下载文件函数，filefold为下载文件存放的下一级文件夹名'''</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">filefold</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="n">filename</span> <span class="o">=</span> <span class="s1">'./'</span> <span class="o">+</span> <span class="n">filefold</span> <span class="o">+</span><span class="s1">'/'</span> <span class="o">+</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># NOTE the stream=True parameter</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">chunk</span><span class="p">:</span> <span class="c1"># filter out keep-alive new chunks</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">filename</span>
</pre></div>
<h3 id="json">json方法</h3>
<p>如果响应是json文件，那么调用这个方法就自动将json文件解码了（相当于json模块的loads）。</p>
<h3 id="status95code">status_code属性</h3>
<p>具体响应的状态码，如404之类的。</p>
<h3 id="headers_1">headers方法</h3>
<p>服务器响应的HTTP头信息。</p>
<h3 id="allow95redirects">allow_redirects</h3>
<p>GET OPTIONS POST PUT PATCH DELETE 这些方法重定向默认打开 True
然后HEAD方法默认重定向关闭。</p>
<h3 id="timeout">timeout参数</h3>
<p>timeout参数控制，如果超时则将抛出 <code>requests.exceptions.Timeout</code> 异常。</p>
<h2 id="_4">异常</h2>
<p>下面这些异常了解下：</p>
<p>遇到网络问题（如：DNS查询失败、拒绝连接等）时，Requests会抛出一个 ConnectionError 异常。</p>
<p>遇到罕见的无效HTTP响应时，Requests则会抛出一个 HTTPError 异常。</p>
<p>若请求超时，则抛出一个 Timeout 异常。</p>
<p>若请求超过了设定的最大重定向次数，则会抛出一个 TooManyRedirects 异常。</p>
<p>所有Requests显式抛出的异常都继承自 requests.exceptions.RequestException 。</p>
<h1 id="requests_1">requests模块高级篇</h1>
<h2 id="_5">会话</h2>
<p>会话对象可以跨多个requests请求对象保持相同的某些参数设置，比如cookies等。</p>
<p>Session对象有requests API的所有方法，即get，post之类。会话对象之前设置的那些参数都会保留在那里，后面调用的get方法还可以加上额外的一些参数设置，如下所示:</p>
<div class="highlight"><pre><span></span>s = requests.Session()
s.auth = ('user', 'pass')
s.headers.update({'x-test': 'true'})

# both 'x-test' and 'x-test2' are sent
s.get('http://httpbin.org/headers', headers={'x-test2': 'true'})
</pre></div>
<h2 id="ssl">SSL验证</h2>
<p>加上 <code>verify=True</code> 即要求对目标主机进行SSL验证。</p>
<h2 id="content_1">响应体的content</h2>
<p>对于响应体含有content却内容较多的情况，可以通过 <code>Stream=True</code> 来让推迟content下载，而只获取header信息。后面遇到 <code>response.content</code> 才实际下载content。</p>
<p>然后还有 <code>Response.iter_content</code> 和 <code>Response.iter_lines</code> 方法来控制工作流，或者以 <code>Response.raw</code> 通过底层urllib3来读取响应对象。</p>
<h3 id="responseiter95content">response.iter_content</h3>
<div class="highlight"><pre><span></span>iter_content(chunk_size=1, decode_unicode=False)
</pre></div>
<p>迭代读取响应体的content内容，设置一次读取多少 <code>chunk_size</code> 。</p>
<h3 id="responseiter95lines">response.iter_lines</h3>
<div class="highlight"><pre><span></span>iter_lines(chunk_size=512, decode_unicode=None)
</pre></div>
<p>迭代读取响应体的content内容，一次读一行。行的内容应该小于chunk_size，一般不设置即可。</p>
<h2 id="_6">身份验证</h2>
<div class="highlight"><pre><span></span>&gt;&gt;&gt; from requests.auth import HTTPBasicAuth
&gt;&gt;&gt; requests.get('https://api.github.com/user', auth=HTTPBasicAuth('user', 'pass'))
&lt;Response [200]&gt;
&gt;&gt;&gt; requests.get('https://api.github.com/user', auth=('user', 'pass'))
&lt;Response [200]&gt;
</pre></div>
<h2 id="_7">代理</h2>
<div class="highlight"><pre><span></span>import requests
</pre></div>
<div class="highlight"><pre><span></span>proxies = {
  "http": "http://10.10.1.10:3128",
  "https": "http://10.10.1.10:1080",
}

requests.get("http://example.org", proxies=proxies)
</pre></div>
<h1 id="_8">附录</h1>
<h2 id="http_1">关于HTTP的补充理论知识</h2>
<p>HTTP协议就支持四种方法：</p>
<ul>
<li><strong>GET:</strong> 从web service 那里提取信息</li>
<li><strong>POST:</strong> 往web service 那里发送信息</li>
<li><strong>PUT:</strong> 在web service 那里更新信息</li>
<li><strong>DELETE:</strong> 在web service 那里删除信息</li>
</ul>
<h3 id="getpost">GET和POST的区别</h3>
<p>参考了 <a href="http://blog.csdn.net/gideal_wang/article/details/4316691">这个网页</a> 。前面谈及的修改网页的url来获取资源，实质就是HTTP的GET方法，也就是GET方法的信息就放在url上的，然后web service服务器会分析这些url，从而相应的决定对客户机的回应方式。而POST方法并不修改url，web service服务器接受的url上并没有任何额外的信息，具体POST方法具体会另外传输一个信息包。一般能够通过GET方法和服务器互动的就采用GET方法，但因为url的局限性，可能某些GET方法并不适用，这是就需要服务器支持对应的POST方法来互动了。至于PUT还有DELETE方法就更加少用了，有些服务器甚至根本就不支持这些冷门的方法。</p>
<h3 id="http_2">HTTP返回错误码含义</h3>
<div class="highlight"><pre><span></span>100: ('Continue', 'Request received, please continue'),
    101: ('Switching Protocols',
          'Switching to new protocol; obey Upgrade header'),

    200: ('OK', 'Request fulfilled, document follows'),
    201: ('Created', 'Document created, URL follows'),
    202: ('Accepted',
          'Request accepted, processing continues off-line'),
    203: ('Non-Authoritative Information', 'Request fulfilled from cache'),
    204: ('No Content', 'Request fulfilled, nothing follows'),
    205: ('Reset Content', 'Clear input form for further input.'),
    206: ('Partial Content', 'Partial content follows.'),

    300: ('Multiple Choices',
          'Object has several resources -- see URI list'),
    301: ('Moved Permanently', 'Object moved permanently -- see URI list'),
    302: ('Found', 'Object moved temporarily -- see URI list'),
    303: ('See Other', 'Object moved -- see Method and URL list'),
    304: ('Not Modified',
          'Document has not changed since given time'),
    305: ('Use Proxy',
          'You must use proxy specified in Location to access this '
          'resource.'),
    307: ('Temporary Redirect',
          'Object moved temporarily -- see URI list'),

    400: ('Bad Request',
          'Bad request syntax or unsupported method'),
    401: ('Unauthorized',
          'No permission -- see authorization schemes'),
    402: ('Payment Required',
          'No payment -- see charging schemes'),
    403: ('Forbidden',
          'Request forbidden -- authorization will not help'),
    404: ('Not Found', 'Nothing matches the given URI'),
    405: ('Method Not Allowed',
          'Specified method is invalid for this server.'),
    406: ('Not Acceptable', 'URI not available in preferred format.'),
    407: ('Proxy Authentication Required', 'You must authenticate with '
          'this proxy before proceeding.'),
    408: ('Request Timeout', 'Request timed out; try again later.'),
    409: ('Conflict', 'Request conflict.'),
    410: ('Gone',
          'URI no longer exists and has been permanently removed.'),
    411: ('Length Required', 'Client must specify Content-Length.'),
    412: ('Precondition Failed', 'Precondition in headers is false.'),
    413: ('Request Entity Too Large', 'Entity is too large.'),
    414: ('Request-URI Too Long', 'URI is too long.'),
    415: ('Unsupported Media Type', 'Entity body in unsupported format.'),
    416: ('Requested Range Not Satisfiable',
          'Cannot satisfy request range.'),
    417: ('Expectation Failed',
          'Expect condition could not be satisfied.'),

    500: ('Internal Server Error', 'Server got itself in trouble'),
    501: ('Not Implemented',
          'Server does not support this operation'),
    502: ('Bad Gateway', 'Invalid responses from another server/proxy.'),
    503: ('Service Unavailable',
          'The server cannot process the request due to a high load'),
    504: ('Gateway Timeout',
          'The gateway server did not receive a timely response'),
    505: ('HTTP Version Not Supported', 'Cannot fulfill request.'),
</pre></div>
<h2 id="_9">参考资料</h2>
<ol>
<li>Foundations of Python Network Programming ，python网络编程基础，[美] John Goerzen 著，莫迟等译 。</li>
<li>计算机网络 [美] 特南鲍姆</li>
<li><a href="http://www.diveintopython3.net/http-web-services.html">diveintopython3 web services 一章</a> 这是 <a href="http://sebug.net/paper/books/dive-into-python3/http-web-services.html">中文网页</a> 。</li>
</ol>

            <section>
<div class="panel-group" id="accordion2">
    <div class="panel panel-default">
        <div class="panel-heading">
            <a class="accordion-toggle disqus-comment-count" data-toggle="collapse" data-parent="#accordion2"
                href="https://a358003542.github.io/articles/requests-module.html#disqus_thread">
                Comments
            </a>
        </div>
        <div id="disqus_thread" class="panel-collapse collapse">
            <div class="panel-body">
                <div class="comments">
                    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'cdwanzes-blog';
        var disqus_identifier = 'https://a358003542.github.io/articles/requests-module.html';
    var disqus_url = 'https://a358003542.github.io/articles/requests-module.html';

    (function() {
         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
         dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

                </div>
            </div>
        </div>
    </div>
</div>
</section>

            <hr/>

        </div>
        <section>
        <div class="col-md-2" style="float:right;font-size:0.9em;">
            <h4>首发于：</h4>
            <time pubdate="pubdate" datetime="2019-09-09T00:00:00+08:00">2019年 9月 9日 </time>

            <h4>分类：</h4>
            <a class="category-link" href="https://a358003542.github.io/categories.html#python_companion-ref">python_companion</a>
            <h4>标签：</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://a358003542.github.io/tags.html#python-ref">python
                    <span>18</span>
</a></li>
            </ul>

        </div>
        </section>
</div>
</article>
    </div>
    <div class="col-md-1"></div>

</div>


<div id="push"></div>
<button id="gotop" type="button" class="btn btn-default">
    <span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span>
</button>

<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a> and updated by <a href="https://github.com/a358003542" title="wanze Home Page">wanze</a></li>
    </ul>
</div>
</footer>

        <script src="https://a358003542.github.io/theme/js/jquery.min.js"></script>
    <script src="https://a358003542.github.io/theme/js/bootstrap.min.js"></script>

    <script src="https://a358003542.github.io/theme/js/moment.min.js"></script>

    <script src="https://a358003542.github.io/theme/js/base.js"></script>

            <script type="text/javascript">
var disqus_shortname = 'cdwanzes-blog';
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>
<script  language="javascript" type="text/javascript">
function uncollapse() {
    if (window.location.hash.match(/^#comment-\d+$/)) {
        $('#disqus_thread').collapse('show');
    }
}
</script>
<script type="text/javascript" language="JavaScript">
uncollapse();
window.onhashchange=function(){
    if (window.location.hash.match(/^#comment-\d+$/))
        window.location.reload(true);
}
</script>
<script>
$('#disqus_thread').on('shown', function () {
    var link = document.getElementsByClassName('accordion-toggle');
    var old_innerHTML = link[0].innerHTML;
    $(link[0]).fadeOut(500, function() {
        $(this).text('Click here to hide comments').fadeIn(500);
    });
    $('#disqus_thread').on('hidden', function () {
        $(link[0]).fadeOut(500, function() {
            $(this).text(old_innerHTML).fadeIn(500);
        });
    })
})
</script>




</body>
</html>