<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="baidu-site-verification" content="D4VqC4HppC"/>
    <meta name="msvalidate.01" content="55CB117A61A6F8286173763FB18D9625"/>

        <meta name="author" content="cdwanze"/>
        <meta name="copyright" content="cdwanze"/>

        <meta property="og:type" content="article"/>
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="python, python语言, " />

<meta property="og:title" content="python语言学习之-技巧大杂烩 "/>
<meta property="og:url" content="https://docs.cdwanze.work/articles/python-cookbook.html" />
<meta property="og:description" content="在logging中使用pprint 参考了 这个网页 。 有的时候logging的输出我们希望调用pprint从而输出打印更加美观些，可以调用pformat函数来达到这个效果： from pprint import pprint, pformat ds = [{&#39;hello&#39;: &#39;there&#39;}] logging.debug(pformat(ds)) and or not的运算优先级 一般是推荐用括号清晰表达，然后not我们知道优先级是最高的。我们再看下面这个例子: &gt;&gt;&gt; True or True and False True 这个例子很好地说明了and和or的优先级顺序，具体就是 and的优先级比or的要高 。 all和any关键词 这是python语言里面的关键词函数，源码很简单，下面列出来，看一下就清楚了: def all(iterable): for element in iterable: if not element: return False return …" />
<meta property="og:site_name" content="cdwanze的博文" />
<meta property="og:article:author" content="cdwanze" />
<meta property="og:article:published_time" content="2018-08-02T00:00:00+08:00" />
<meta property="" content="2019-06-25T00:00:00+08:00" />
<meta name="twitter:title" content="python语言学习之-技巧大杂烩 ">
<meta name="twitter:description" content="在logging中使用pprint 参考了 这个网页 。 有的时候logging的输出我们希望调用pprint从而输出打印更加美观些，可以调用pformat函数来达到这个效果： from pprint import pprint, pformat ds = [{&#39;hello&#39;: &#39;there&#39;}] logging.debug(pformat(ds)) and or not的运算优先级 一般是推荐用括号清晰表达，然后not我们知道优先级是最高的。我们再看下面这个例子: &gt;&gt;&gt; True or True and False True 这个例子很好地说明了and和or的优先级顺序，具体就是 and的优先级比or的要高 。 all和any关键词 这是python语言里面的关键词函数，源码很简单，下面列出来，看一下就清楚了: def all(iterable): for element in iterable: if not element: return False return …">

    <title>
python语言学习之-技巧大杂烩  · cdwanze的博文
</title>


        <link href="https://docs.cdwanze.work/theme/css/font-awesome.css" rel="stylesheet"
              media="screen">
        <link href="https://docs.cdwanze.work/theme/css/bootstrap.min.css" rel="stylesheet"
              media="screen">

            <link rel="stylesheet" type="text/css"
                  href="https://docs.cdwanze.work/theme/css/pygments.css" media="screen">
            <link rel="stylesheet" type="text/css"
                  href="https://docs.cdwanze.work/theme/css/elegant.css" media="screen">
            <link rel="stylesheet" type="text/css"
                  href="https://docs.cdwanze.work/theme/css/custom.css" media="screen">






</head>
<body>

<nav class="navbar">
    <div class="navbar navbar-default" role="navigation">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed"
                    data-toggle="collapse" data-target=".navbar-collapse"
                    aria-expanded="false">
                <span class="sr-only">Navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <a class="navbar-brand" href="https://www.cdwanze.work"><span
                    class=site-name>网站首页</span></a>
        </div>


        <div class="navbar-collapse collapse">
            <form action="https://docs.cdwanze.work/search.html"
                  onsubmit="return validateForm(this.elements['q'].value);"
                  class="navbar-form navbar-left">
                <div class="form-group">
                    <input type="text" name="q" id="tipue_search_input"
                           class="form-control" placeholder="Search..."
                           style="width:430px;">
                </div>
                <button class="btn btn-default" type="submit">搜索</button>
            </form>


            <ul class="nav navbar-nav nav-pills navbar-right">
                <li >
                    <a href="https://docs.cdwanze.work">博文首页</a></li>

                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle"
                           data-toggle="dropdown" role="button"
                           aria-haspopup="true" aria-expanded="false">查找文章<span
                                class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a class="slowscroll" href="/categories.html">按分类</a>
                            </li>
                            <li><a class="slowscroll" href="/tags.html">按标签</a>
                            </li>
                        </ul>
                    </li>


                        <li >
                            <a href="https://docs.cdwanze.work/guan-yu-ben-wang-zhan.html">关于本网站</a>
                        </li>
                        <li >
                            <a href="https://docs.cdwanze.work/gong-gao.html">公告</a>
                        </li>
            </ul>


        </div>
    </div>
</nav>


<div class="container-fluid">
    <div class="col-md-1 col-md-1-left"></div>
    <div class="col-md-10">
<article>
<div class="row">
    <header class="page-header col-md-10 col-md-offset-2">
    <h1><a href="https://docs.cdwanze.work/articles/python-cookbook.html"> python语言学习之-技巧大杂烩  </a></h1>
    </header>
</div>

<div class="row">
    <div class="col-md-2 table-of-content">
        <nav>
        <h4>目录</h4>
        <div class="toc">
<ul>
<li><a href="#loggingpprint">在logging中使用pprint</a></li>
<li><a href="#and-or-not">and or not的运算优先级</a></li>
<li><a href="#allany">all和any关键词</a></li>
<li><a href="#_1">三元运算符</a></li>
<li><a href="#__name__-__file__">__name__ 和 __file__</a></li>
<li><a href="#localsglobals">locals和globals</a></li>
<li><a href="#_2">获取本模块对象</a></li>
<li><a href="#_3">根据字符串获取模块对象</a></li>
<li><a href="#_4">检查某个变量是不是模块对象</a></li>
<li><a href="#assert">assert语句</a></li>
<li><a href="#_5">属性管理的函数</a></li>
<li><a href="#flatten">可迭代对象flatten操作</a></li>
<li><a href="#__missing__">__missing__方法</a></li>
<li><a href="#product">product函数</a></li>
<li><a href="#deque">deque结构</a></li>
<li><a href="#python">python中类继承的顺序</a></li>
<li><a href="#_6">查找多个最大最小元素的情况</a></li>
<li><a href="#_7">获取一个月最后的一天</a></li>
<li><a href="#ordereddict">OrderedDict类</a></li>
<li><a href="#counter">Counter类</a></li>
<li><a href="#_8">字符串比较大小</a><ul>
<li><a href="#_9">中文比较大小？</a></li>
<li><a href="#ordchr">ord和chr函数</a></li>
</ul>
</li>
<li><a href="#configparse">configparse处理特殊字符</a></li>
<li><a href="#_10">给某个对象动态加载一个方法</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="col-md-8 article-content">

            
            
<h2 id="loggingpprint">在logging中使用pprint</h2>
<p>参考了 <a href="https://stackoverflow.com/questions/11093236/use-logging-print-the-output-of-pprint">这个网页</a> 。</p>
<p>有的时候logging的输出我们希望调用pprint从而输出打印更加美观些，可以调用pformat函数来达到这个效果：</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span><span class="p">,</span> <span class="n">pformat</span>
<span class="n">ds</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">'hello'</span><span class="p">:</span> <span class="s1">'there'</span><span class="p">}]</span>
<span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">pformat</span><span class="p">(</span><span class="n">ds</span><span class="p">))</span>
</pre></div>
<h2 id="and-or-not">and or not的运算优先级</h2>
<p>一般是推荐用括号清晰表达，然后not我们知道优先级是最高的。我们再看下面这个例子:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">True</span> <span class="k">or</span> <span class="k">True</span> <span class="k">and</span> <span class="k">False</span>
<span class="k">True</span>
</pre></div>
<p>这个例子很好地说明了and和or的优先级顺序，具体就是 and的优先级比or的要高 。</p>
<h2 id="allany">all和any关键词</h2>
<p>这是python语言里面的关键词函数，源码很简单，下面列出来，看一下就清楚了:</p>
<div class="highlight"><pre><span></span><span class="nv">def</span> <span class="nv">all</span><span class="ss">(</span><span class="nv">iterable</span><span class="ss">)</span>:
    <span class="k">for</span> <span class="nv">element</span> <span class="nv">in</span> <span class="nv">iterable</span>:
        <span class="k">if</span> <span class="nv">not</span> <span class="nv">element</span>:
            <span class="k">return</span> <span class="nv">False</span>
    <span class="k">return</span> <span class="nv">True</span>

<span class="nv">def</span> <span class="nv">any</span><span class="ss">(</span><span class="nv">iterable</span><span class="ss">)</span>:
    <span class="k">for</span> <span class="nv">element</span> <span class="nv">in</span> <span class="nv">iterable</span>:
        <span class="k">if</span> <span class="nv">element</span>:
            <span class="k">return</span> <span class="nv">True</span>
    <span class="k">return</span> <span class="nv">False</span>
</pre></div>
<p>如果用语言表述的话是:</p>
<ul>
<li>all，都是True，则返回True，否则返回False</li>
<li>any，只要有一个True则返回True，否则返回False。</li>
</ul>
<h2 id="_1">三元运算符</h2>
<p>也就是类似这样的结构:</p>
<div class="highlight"><pre><span></span><span class="k">loop</span> <span class="o">=</span> <span class="k">loop</span> <span class="k">if</span> <span class="k">loop</span> <span class="nv">is</span> <span class="nv">not</span> <span class="nv">None</span> <span class="k">else</span> <span class="nv">get_event_loop</span><span class="ss">()</span>
</pre></div>
<p>通常我们在处理函数的入口参数实现默认值的情况的时候会用到，比如上面一般函数参数那里写着 <code>loop=None</code> ，用上面这种一行形式更简洁一些。而我们不直接在函数定义的那里采用默认值可能有两种情况，一是该默认值并不方便作为默认值，而最好默认为None；还有一种情况是默认值是需要通过某个函数等运算得到的。</p>
<h2 id="__name__-__file__"><code>__name__</code> 和 <code>__file__</code></h2>
<p>这里所谓脚本被引入是指用import或者from语句被另外一个脚本引入进去，而这里所谓的脚本被执行是指直接如 <code>python test.py</code> 这样的形式执行该py脚本。</p>
<p>这两种形式很有一些区别，下面慢慢谈论:</p>
<ul>
<li>
<p><code>__name__</code> 的区别。这个大家应该很熟悉了。如果脚本是被引入的，<code>__name__</code> 的值是该引入的脚本文件名，比如引入的是 <code>test.py</code> ，那么该脚本被引入，对于这个test.py文件来说，其内的 <code>__name__</code> 的值就是 <code>test</code> ，也就是 <strong>模块名</strong>  ；而如果是作为脚本被执行，则该 <code>__name__</code> 是 <code>__main__</code> 。</p>
</li>
<li>
<p><code>__file__</code> 的区别。如果脚本是被执行的，假设该脚本文件是 <code>hello.py</code> ，那么在这个被执行脚本中， <code>__file__</code> 的值是 <code>hello.py</code> ，也就是 <strong>文件名</strong> 。如果是被引用的，那么对于那个被引入的脚本来说， <code>__file__</code> 的值是该被引入脚本相对系统来说的 <strong>完整文件名</strong> ，比如是 <code>/home/wanze/桌面/hello.py</code> 。</p>
</li>
</ul>
<h2 id="localsglobals">locals和globals</h2>
<p>python的 <code>locals()</code> 返回本函数内的局部变量字典值，而 <code>globals()</code> 则返回本模块文件的全局变量。 <code>locals</code> 是只读的，而 <code>globals()</code> 不是，我们可以利用<code>globals()</code> 对脚本文件玩出一些新花样。</p>
<h2 id="_2">获取本模块对象</h2>
<p>如下所示，可以获取本模块内的变量。</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">current_module</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>

<span class="n">old_module_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">current_module</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>


<span class="c1"># for k, v in old_module_dict.items():</span>
<span class="c1">#     if k == 'case_base':</span>
<span class="c1">#         pass</span>
<span class="c1">#     elif k.startswith('case_'):</span>
<span class="c1">#         if issubclass(v, case_base):</span>
<span class="c1">#             URL_CASES.append(v)</span>
</pre></div>
<h2 id="_3">根据字符串获取模块对象</h2>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">importlib</span>
<span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="s1">'what.what'</span><span class="p">)</span>
</pre></div>
<h2 id="_4">检查某个变量是不是模块对象</h2>
<p>参考了 <a href="https://stackoverflow.com/questions/865503/how-to-isinstancex-module">这个网页</a></p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">types</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">os</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">)</span>
<span class="bp">True</span>
</pre></div>
<h2 id="assert">assert语句</h2>
<p>assert语句简单的理解就是 <code>assert True</code> ，正常刷过去，而 <code>assert False</code> 将抛出<code>AssertionError</code> 。</p>
<h2 id="_5">属性管理的函数</h2>
<p>hasattr，setattr，getattr，delattr，这些函数都属于关于python中各个对象的属性管理函数，其都是内置函数。</p>
<p>其中hasattr(object, name)检测某个对象有没有某个属性。</p>
<p>setattr(object, name, value)用于设置某个对象的某个属性为某个值，<code>setattr(x,a,3)</code> 对应 <code>x.a = 3</code> 这样的语法。</p>
<p>getattr(object, name[, default])用于取某个对象的某个属性的值，对应 <code>object.name</code> 这样的语法。</p>
<p>delattr(object,name)用于删除某个对象的某个属性，对应 <code>del object.name</code> 这样的语法。</p>
<h2 id="flatten">可迭代对象flatten操作</h2>
<div class="highlight"><pre><span></span><span class="n">a_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span class="n">print</span><span class="p">(</span><span class="n">list</span><span class="p">(</span><span class="n">itertools</span><span class="p">.</span><span class="k">chain</span><span class="p">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">a_list</span><span class="p">)))</span>
<span class="o">#</span> <span class="k">Output</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="o">#</span> <span class="k">or</span>
<span class="n">print</span><span class="p">(</span><span class="n">list</span><span class="p">(</span><span class="n">itertools</span><span class="p">.</span><span class="k">chain</span><span class="p">(</span><span class="o">*</span><span class="n">a_list</span><span class="p">)))</span>
<span class="o">#</span> <span class="k">Output</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
</pre></div>
<h2 id="__missing__">__missing__方法</h2>
<p>对于字典或者字典的子类，你可以通过定义 <code>__missing__</code> 方法来回避找不到键值而抛出的 <code>KeyError</code> ，参考了 <a href="http://stackoverflow.com/questions/635483/what-is-the-best-way-to-implement-nested-dictionaries-in-python">这个网页</a> 。如下所示:</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">NestedDict</span><span class="p">(</span><span class="n">collections</span><span class="o">.</span><span class="n">UserDict</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">Implement this data structure:</span>
<span class="sd">{"section":{},</span>
<span class="sd">}</span>
<span class="sd">'''</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__missing__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">update_in_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">section</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_in_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span><span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">section</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete_in_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">section</span><span class="p">,</span><span class="n">key</span><span class="p">):</span>
        <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">section</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">set_in_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">section</span><span class="p">,</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">section</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</pre></div>
<p>如果找不到该key，则该类会自动赋值一个新的 dict()并作为该key的值。你可能希望使用 <code>type(self)()</code> ，但这种风格对json的兼容性不太好，推荐还是都用dict类。</p>
<h2 id="product">product函数</h2>
<p>product函数在 <code>itertools</code> 模块里面，按照官方文档的说明是product(A, B)返回值等价于((x,y) for x in A for y in B)，也就是各种可能的组合情况（类似于笛卡尔积的概念）:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">list</span><span class="p">(</span><span class="n">product</span><span class="p">([</span><span class="s1">'a'</span><span class="p">,</span><span class="s1">'b'</span><span class="p">],[</span><span class="s1">'c'</span><span class="p">]))</span>
<span class="p">[(</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'b'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">)]</span>
</pre></div>
<p>此外单一迭代加上 <code>repeat</code> 参数也会生成一些很有意思的结果:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">list</span><span class="p">(</span><span class="n">product</span><span class="p">([</span><span class="s1">'True'</span><span class="p">,</span><span class="s1">'False'</span><span class="p">],</span><span class="n">repeat</span><span class="o">=</span><span class="n">len</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">)))</span>
<span class="p">[(</span><span class="s1">'True'</span><span class="p">,</span> <span class="s1">'True'</span><span class="p">,</span> <span class="s1">'True'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'True'</span><span class="p">,</span> <span class="s1">'True'</span><span class="p">,</span> <span class="s1">'False'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'True'</span><span class="p">,</span> <span class="s1">'False'</span><span class="p">,</span> <span class="s1">'True'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'True'</span><span class="p">,</span> <span class="s1">'False'</span><span class="p">,</span> <span class="s1">'False'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'False'</span><span class="p">,</span> <span class="s1">'True'</span><span class="p">,</span> <span class="s1">'True'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'False'</span><span class="p">,</span> <span class="s1">'True'</span><span class="p">,</span> <span class="s1">'False'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'False'</span><span class="p">,</span> <span class="s1">'False'</span><span class="p">,</span> <span class="s1">'True'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'False'</span><span class="p">,</span> <span class="s1">'False'</span><span class="p">,</span> <span class="s1">'False'</span><span class="p">)]</span>
</pre></div>
<p>这可以看作:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">list</span><span class="p">(</span><span class="n">product</span><span class="p">([</span><span class="s1">'True'</span><span class="p">,</span><span class="s1">'False'</span><span class="p">],[</span><span class="s1">'True'</span><span class="p">,</span><span class="s1">'False'</span><span class="p">],[</span><span class="s1">'True'</span><span class="p">,</span><span class="s1">'False'</span><span class="p">]))</span>
<span class="p">[(</span><span class="s1">'True'</span><span class="p">,</span> <span class="s1">'True'</span><span class="p">,</span> <span class="s1">'True'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'True'</span><span class="p">,</span> <span class="s1">'True'</span><span class="p">,</span> <span class="s1">'False'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'True'</span><span class="p">,</span> <span class="s1">'False'</span><span class="p">,</span> <span class="s1">'True'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'True'</span><span class="p">,</span> <span class="s1">'False'</span><span class="p">,</span> <span class="s1">'False'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'False'</span><span class="p">,</span> <span class="s1">'True'</span><span class="p">,</span> <span class="s1">'True'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'False'</span><span class="p">,</span> <span class="s1">'True'</span><span class="p">,</span> <span class="s1">'False'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'False'</span><span class="p">,</span> <span class="s1">'False'</span><span class="p">,</span> <span class="s1">'True'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'False'</span><span class="p">,</span> <span class="s1">'False'</span><span class="p">,</span> <span class="s1">'False'</span><span class="p">)]</span>
</pre></div>
<h2 id="deque">deque结构</h2>
<p>本小节主要参考了 <a href="http://python3-cookbook.readthedocs.io/zh_CN/latest/c01/p03_keep_last_n_items.html">这个网页</a> 。</p>
<p>我想读者可能已经接触过queue结构了吧，queue结构是一端进data，然后另一端出data，这样形成了先进先出的数据流。而deque结构两端都可以进两端都可以出，这看上有点古怪，如果你只使用一端的话，那么其好像一个堆栈结构，是先进后出的；而如果一端只是进，另一端只是出，其又好像一个queue结构。那么其有什么优势呢？deque结构最大的优势，也就是我们需要使用它的原因是: 其两端插入元素和删除元素的时间复杂度是O(1)，是一个常数级，而列表开头插入或删除元素的时间复杂度是O(N)，所以如果我们需要一个类似列表的数据存储结构，而这个数据结构中，开头的几个元素和末尾的几个元素都比较重要，经常被访问，那么就应该使用deque结构。</p>
<p>上面的网页介绍了这么一个函数，用来返回一个文件最后的几行:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>
<span class="k">def</span> <span class="nf">tail</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="s1">'Return the last n lines of a file'</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">deque</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
<p>其是利用了deque还有一个size定长的概念，输入的队列进入deque时较老的元素会被丢弃。我不太清楚这种做法效率如何，不过这种写法还是很优雅的。</p>
<h2 id="python">python中类继承的顺序</h2>
<p>我们知道python中类的搜索顺序是从左到右的，比如：</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="n">D</span>(<span class="n">A</span>,<span class="n">B</span>): <span class="nb">pass</span>
</pre></div>
<p>D的属性是先从A找，然后再从B找。但从类的继承概念上来说，如果A类和B类之间没有层次关系，那么他们顺序随便都没问题，但如果B类是更底层的Base类，那么其是应该放在最右边的。这在关于Mixin类中写法是要严格如下所示的：</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="n">MyClass</span>(<span class="n">Mixin2</span>, <span class="n">Mixin1</span>, <span class="n">BaseClass</span>):
    <span class="nb">pass</span>
</pre></div>
<h2 id="_6">查找多个最大最小元素的情况</h2>
<p>如果只是想要获知某些数据的一个最大值或者一个最小值，那么当然用 <code>max</code> 或 <code>min</code> 方法就可以了。这里讨论的情况是如果你想要获知某些数据的多个最大值或多个最小值。一般想到的就是先对这些数据进行排序，然后进行切片操作。参考资料2的第一章第四节讨论的方法实际上是利用最小堆结构进行堆排序然后提出最大或最小的那个几个元素。</p>
<p>大体过程就是:</p>
<div class="highlight"><pre><span></span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="kn">import</span> <span class="nn">heapq</span>
<span class="n">heapq</span><span class="o">.</span><span class="n">heapify</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
<span class="n">heapq</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">lst</span><span class="p">)</span>
<span class="n">heapq</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">lst</span><span class="p">)</span>
</pre></div>
<h2 id="_7">获取一个月最后的一天</h2>
<p>首先要说的是利用python的datetime和timedelta对于 <code>days</code> 的加减操作是能够很好地支持跨月问题的:</p>
<div class="highlight"><pre><span></span>    <span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">d</span>
    <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">337204</span><span class="p">)</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span> <span class="o">=</span> <span class="mi">29</span><span class="p">)</span>
    <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">337204</span><span class="p">)</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span> <span class="o">=</span> <span class="mi">28</span><span class="p">)</span>
    <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">337204</span><span class="p">)</span>
</pre></div>
<p>但是有的时候你就是需要直接获知某个月份的最后一天是30还是31等等，然后利用replace来获得一个月的最后一天。这个时候你需要利用 calendar 的 <code>monthrange</code> 函数。参考了 <a href="http://stackoverflow.com/questions/42950/get-last-day-of-the-month-in-python">这个网页</a> 。</p>
<div class="highlight"><pre><span></span>    <span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="p">.</span><span class="k">replace</span><span class="p">(</span><span class="k">year</span> <span class="o">=</span> <span class="mi">2016</span><span class="p">,</span><span class="k">month</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="k">day</span> <span class="o">=</span> <span class="n">monthrange</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span><span class="mi">4</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">337204</span><span class="p">)</span>
</pre></div>
<h2 id="ordereddict">OrderedDict类</h2>
<p>字典一般没有排序的需求吧，就是有也可以输出的时候再排序，再说OrderedDict和一般字典比较起来存储开销大了一倍，能不用就不用吧。不过在某些情况下，用这个类确实能带来一些便利。我第一次遇到这种情况大体是在bilibili的api对接那里，其计算密钥需要将所有参数排序然后urlencode为字符串然后再基于这个字符串进行一些计算。</p>
<div class="highlight"><pre><span></span>    <span class="n">params</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">sorted</span><span class="p">(</span><span class="n">params</span><span class="p">.</span><span class="n">items</span><span class="p">(),</span> <span class="k">key</span><span class="o">=</span><span class="n">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">string</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
<p>大体在某些情况下，总是要求某个字典值变量按照某个顺序输出，那么用OrderedDict还是很便利的。其顺序就是按照其插入顺序来的，所以进入之前我们还是要做字典排序工作，所以我们可以看作这是一个自动进行了某种操作的便捷对象吧。</p>
<h2 id="counter">Counter类</h2>
<p>Counter类是真有用，而且还不是一般的好用。下面的例子来自参考资料2，不多说，看看代码大体就了解了:</p>
<div class="highlight"><pre><span></span>    <span class="n">words</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">'look'</span><span class="p">,</span> <span class="s1">'into'</span><span class="p">,</span> <span class="s1">'my'</span><span class="p">,</span> <span class="s1">'eyes'</span><span class="p">,</span> <span class="s1">'look'</span><span class="p">,</span> <span class="s1">'into'</span><span class="p">,</span> <span class="s1">'my'</span><span class="p">,</span> <span class="s1">'eyes'</span><span class="p">,</span>
        <span class="s1">'the'</span><span class="p">,</span> <span class="s1">'eyes'</span><span class="p">,</span> <span class="s1">'the'</span><span class="p">,</span> <span class="s1">'eyes'</span><span class="p">,</span> <span class="s1">'the'</span><span class="p">,</span> <span class="s1">'eyes'</span><span class="p">,</span> <span class="s1">'not'</span><span class="p">,</span> <span class="s1">'around'</span><span class="p">,</span> <span class="s1">'the'</span><span class="p">,</span>
        <span class="s1">'eyes'</span><span class="p">,</span> <span class="s2">"don't"</span><span class="p">,</span> <span class="s1">'look'</span><span class="p">,</span> <span class="s1">'around'</span><span class="p">,</span> <span class="s1">'the'</span><span class="p">,</span> <span class="s1">'eyes'</span><span class="p">,</span> <span class="s1">'look'</span><span class="p">,</span> <span class="s1">'into'</span><span class="p">,</span>
        <span class="s1">'my'</span><span class="p">,</span> <span class="s1">'eyes'</span><span class="p">,</span> <span class="s2">"you're"</span><span class="p">,</span> <span class="s1">'under'</span>
    <span class="p">]</span>
    <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
    <span class="n">word_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
    <span class="c1"># 出现频率最高的3个单词</span>
    <span class="n">top_three</span> <span class="o">=</span> <span class="n">word_counts</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">top_three</span><span class="p">)</span>
    <span class="c1"># Outputs [('eyes', 8), ('the', 5), ('look', 4)]</span>
</pre></div>
<p>Counter 对象是字典的子类，所以字典的一般方法它都有，下面就不赘述了。然后 <code>update</code> 方法我们应该理解为同key之间的加法， 此外还有 <code>subtract</code> 方法可以看作同key之间的减法。此外你还可以做:</p>
<p>这种加减运算和上面提及的 update 方法和 subtract 方法还是有点区别的，加法大体类似，主要是减法将会自动去掉计数小于等于零的项，而 <code>subtract</code> 方法不会。</p>
<div class="highlight"><pre><span></span>    <span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">morewords</span><span class="p">)</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">a</span>
    <span class="n">Counter</span><span class="p">(</span><span class="err">{</span><span class="s1">'eyes'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">'the'</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">'look'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">'into'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">'my'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">'around'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="ss">"you're"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="ss">"don't"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'under'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'not'</span><span class="p">:</span> <span class="mi">1</span><span class="err">}</span><span class="p">)</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">b</span>
    <span class="n">Counter</span><span class="p">(</span><span class="err">{</span><span class="s1">'eyes'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'looking'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'are'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'in'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'not'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'you'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">'my'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'why'</span><span class="p">:</span> <span class="mi">1</span><span class="err">}</span><span class="p">)</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="o">#</span> <span class="n">Combine</span> <span class="n">counts</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="k">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="k">c</span>
    <span class="n">Counter</span><span class="p">(</span><span class="err">{</span><span class="s1">'eyes'</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">'the'</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">'look'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">'my'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">'into'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">'not'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">'around'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="ss">"you're"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="ss">"don't"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'in'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'why'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">'looking'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'are'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'under'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'you'</span><span class="p">:</span> <span class="mi">1</span><span class="err">}</span><span class="p">)</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="o">#</span> <span class="n">Subtract</span> <span class="n">counts</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">d</span>
    <span class="n">Counter</span><span class="p">(</span><span class="err">{</span><span class="s1">'eyes'</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">'the'</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">'look'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">'into'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">'my'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'around'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="ss">"you're"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="ss">"don't"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'under'</span><span class="p">:</span> <span class="mi">1</span><span class="err">}</span><span class="p">)</span>
    <span class="o">&gt;&gt;&gt;</span>
</pre></div>
<p>这个数据结构最为人们数值的统计频数了，通过调用 <code>most_common(n)</code> 方法，n是排行榜的前n名。</p>
<h2 id="_8">字符串比较大小</h2>
<p>读者可以实验一下python中字符串之间是可以比较大小的：</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="s1">'abc'</span> <span class="o">&gt;</span> <span class="s1">'ab'</span>
<span class="k">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">'fabc'</span> <span class="o">&gt;</span> <span class="s1">'abc'</span>
<span class="k">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">'3.04'</span> <span class="o">&gt;</span> <span class="s1">'3'</span>
<span class="k">True</span>
</pre></div>
<p>这个特性有的时候很有用的，具体是如何比较大小的呢？按照python官方文档的描述，采用的是词典编纂顺序。具体描述信息如下：</p>
<blockquote>
<p>序列之间比较大小是，首先两个序列各自的第一个元素开始比较，如果它们相同，则进行下一个比较，直到任何一个序列被穷尽。如果两个序列各自比较的类型都是相同的，那么整个过程将一直进行下去。如果两个序列是相等的则认为它们是相等的，如果某一个序列是另外一个序列的子序列，则那个短的序列认为比长的序列要小。具体到每一个元素的大小比较，是按照ASCII顺序对其进行比较的。</p>
</blockquote>
<h3 id="_9">中文比较大小？</h3>
<p>读者这时会想到，既然python中字符串都默认是unicode编码（utf-8），那么中文应该也是能够比较大小的吧，事实确实如此：</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="s1">'章'</span> <span class="o">&gt;</span> <span class="s1">'张'</span>
<span class="k">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">'章'</span> <span class="o">&lt;</span> <span class="s1">'张'</span>
<span class="k">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ord</span><span class="p">(</span><span class="s1">'章'</span><span class="p">)</span>
<span class="mi">31456</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ord</span><span class="p">(</span><span class="s1">'张'</span><span class="p">)</span>
<span class="mi">24352</span>
</pre></div>
<p>感兴趣的读者可以打开字符映射表看一下，'张'对应的unicode编号是U+5F20，你输入0x5f20，返回的正是24352。如果你输入hex(24352)，返回的就是'0x5f20'。</p>
<h3 id="ordchr">ord和chr函数</h3>
<p>ord函数接受 一个 字符，然后返回其unicode编码，十进制的。chr函数是ord函数的反向，比如你输入24352这个十进制uniocde，就返回了对应的字符。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">chr</span><span class="p">(</span><span class="mi">24352</span><span class="p">)</span>
<span class="s1">'张'</span>
</pre></div>
<p>所以我们可以总结到，python3的字符串比较大小，是基于utf-8编码的。</p>
<h2 id="configparse">configparse处理特殊字符</h2>
<p>configparse对于某些特殊字符可能会报错，参考了 <a href="https://stackoverflow.com/questions/14340366/configparser-and-string-with">这个问题</a> ，推荐使用 <code>RawConfigParser</code> ，这样就可以解决问题。</p>
<h2 id="_10">给某个对象动态加载一个方法</h2>
<p>这里主要参考了 <a href="http://stackoverflow.com/questions/962962/python-changing-methods-and-attributes-at-runtime">这个网页</a> 。</p>
<p>具体原理还是很简单的，那就是构建一个函数对象，然后将这个对象赋值给某个对象。但这里的函数对象如果要接受self参数的话，其作为类的方法还是需要一些特殊的处理的。</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Test</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="n">test</span> <span class="o">=</span> <span class="n">Test</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"hello"</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">types</span>
<span class="n">test</span><span class="o">.</span><span class="n">hello</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="n">hello</span><span class="p">,</span><span class="n">Test</span><span class="p">)</span>

<span class="n">test</span><span class="o">.</span><span class="n">hello</span><span class="p">()</span>
</pre></div>
<p>上面的types.MethodType是用来构建一个类的方法的，其第一个参数是具体的函数对象，第二个参数是对应的类或实例。</p>
<p>然后上面的例子继续优化就是如下的形式:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">types</span>

<span class="k">class</span> <span class="nc">Test</span><span class="p">():</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">removeVariable</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">delattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">addMethod</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">func</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="bp">cls</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"hello"</span><span class="p">)</span>

<span class="n">test</span> <span class="o">=</span> <span class="n">Test</span><span class="p">()</span>

<span class="n">Test</span><span class="o">.</span><span class="n">addMethod</span><span class="p">(</span><span class="n">hello</span><span class="p">)</span>

<span class="n">test</span><span class="o">.</span><span class="n">hello</span><span class="p">()</span>
</pre></div>
<p>你看到了这里的addMethod是作用于本类的，当然你也可以选择作用于本实例:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">types</span>

<span class="k">class</span> <span class="nc">Test</span><span class="p">():</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">removeVariable</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">delattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">addMethod</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">func</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="bp">cls</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">addMethod2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">func</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="bp">self</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"hello"</span><span class="p">)</span>

<span class="n">test</span> <span class="o">=</span> <span class="n">Test</span><span class="p">()</span>

<span class="n">test</span><span class="o">.</span><span class="n">addMethod2</span><span class="p">(</span><span class="n">hello</span><span class="p">)</span>

<span class="n">test</span><span class="o">.</span><span class="n">hello</span><span class="p">()</span>
</pre></div>
<p>这样这个函数就只加在本实例上面了，这用处不太大。</p>
            
            
            <hr/>

        </div>
        <section>
        <div class="col-md-2" style="float:right;font-size:0.9em;">
            <h4>首发于：</h4>
            <time pubdate="pubdate" datetime="2018-08-02T00:00:00+08:00">2018年 8月 2日 </time>

<h4>最近更新于：</h4>
<time datetime="2019-06-25T00:00:00+08:00">2019年 6月 25日 </time>

            <h4>分类：</h4>
            <a class="category-link" href="https://docs.cdwanze.work/categories.html#pythonyu-yan-ref">python语言</a>
            <h4>标签：</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://docs.cdwanze.work/tags.html#python-ref">python
                    <span>12</span>
</a></li>
            </ul>
        </div>
        </section>
</div>
</article>
    </div>
    <div class="col-md-1"></div>

</div>


<div id="push"></div>


<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a> and updated by <a href="http://www.cdwanze.work" title="cdwanze Home Page">cdwanze</a></li>
    </ul>
</div>
</footer>

        <script src="https://docs.cdwanze.work/theme/js/jquery.min.js"></script>
    <script src="https://docs.cdwanze.work/theme/js/bootstrap.min.js"></script>
    <script>
        function validateForm(query) {
            return (query.length > 0);
        }
    </script>

    <script>
        function adjust_search_width() {
            var w = document.documentElement.clientWidth;
            if ((w > 755) && (w < 975)) {
                plus_width = w - 755;
                $('.navbar-form .form-control').outerWidth(210 + plus_width);
            } else if (w >= 975) {
                $('.navbar-form .form-control').outerWidth(210 + 220);
            } else if (w <= 755) {
                $('.navbar-form .form-control').css('width', '100%')
            }
        }

        $(document).ready(function () {
            adjust_search_width();
        });

        window.onresize = function () {
            adjust_search_width();
        }

    </script>


    



</body>
</html>