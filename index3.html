<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="baidu-site-verification" content="D4VqC4HppC" />
	<meta name="msvalidate.01" content="55CB117A61A6F8286173763FB18D9625" />

    <meta name="author" content="cdwanze"/>
    <meta name="copyright" content="cdwanze"/>

     <meta property="og:type" content="article"/>
    <meta name="twitter:card" content="summary">

 <meta property="og:title" content="cdwanze的博文" />
<meta name="twitter:title" content="cdwanze的博文"> <meta property="og:url" content="" />  <meta property="og:site_name" content="cdwanze的博文" />
<meta property="og:article:author" content="cdwanze" />       <title> cdwanze的博文 </title>


    <link href="/theme/css/font-awesome.css" rel="stylesheet" media="screen">
    <link href="/theme/css/bootstrap.min.css" rel="stylesheet" media="screen">

    <link rel="stylesheet" type="text/css" href="/theme/css/pygments.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/theme/css/elegant.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/theme/css/custom.css" media="screen">






</head>
<body>

<nav class="navbar">
    <div class="navbar navbar-default" role="navigation">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" aria-expanded="false">
                <span class="sr-only">Navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <a class="navbar-brand" href="/"><span class=site-name>网站首页</span></a>
        </div>


        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav nav-pills navbar-right">
                <li  class="active">
                    <a href="">博文首页</a></li>

                <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">查找文章<span class="caret"></span></a>
                 <ul class="dropdown-menu">
                  <li><a class="slowscroll" href="/categories.html">按分类</a></li>
                 <li><a class="slowscroll" href="/tags.html">按标签</a></li>
                </ul>
                </li>


                <li >
                    <a href="/guan-yu-ben-wang-zhan.html">关于本网站</a></li>
                <li >
                    <a href="/gong-gao.html">公告</a></li>
            </ul>

            <form action="/search.html" onsubmit="return validateForm(this.elements['q'].value);" class="navbar-form navbar-left">
                <div class="form-group">
                <input type="text" name="q"  id="tipue_search_input" class="form-control" placeholder="Search..." style="width:350px">
                </div>
                <button class="btn btn-default" type="submit">搜索</button>
            </form>
        </div>
    </div>
</nav>


<div class="container-fluid">
    <div class="col-md-1 col-md-1-left"></div>
    <div class="col-md-10">
  
<style>
    article {
        border: 1px solid #aaa;
    }

    section {
        padding: 1em;
    }

    article > p {
        padding-left: 0.5em;
        padding-right: 0.5em;
    }

    #gotop{
        position:fixed;
        right: 12% ;
        float:right ;
        top: 50%;
    }
    @media screen and (max-width: 600px) {
        #gotop{
            display:none;
        }
    }
</style>

<button id="gotop" type="button" class="btn btn-default">
    <span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span>
  </button>



<div class="row">

    <div class="row">
     </div>

      <div class="row">
        <div class="col-md-8 col-md-offset-2">
            <header>
                <h1 id="recent-posts">最近博文
                    <a id="allposts" href="/archives.html">所有博文</a>
                </h1>
            </header>


            <div class="recent-posts">
 <nav aria-label="Page Navigation">
    <ul class="pager">
        <li class="previous">
            <a href="/index2.html" aria-label="Previous" >
                <span aria-hidden="true">&larr;<span>Previous</span></span>
            </a>
        </li>


        <li class="next">
            <a href="/index4.html" aria-label="Next" >
                <span aria-hidden="true">&rarr;<span>Next</span></span>
            </a>
        </li>

    </ul>
</nav>
 
                <article>

                    <h1 class="page-header"><a href="/articles/sqlalchemy-module.html">sqlalchemy模块  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#shu-ju-ku-ref">数据库
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-07-10T00:00:00+08:00">2018年 7月 10日
                            </time>
                        </div>
                    </section>
                    
<h2 id="_1">前言</h2>
<p>老实说sqlalchemy这个模块特别难学，主要原因倒不是这个模块本身，阻碍我很好地学习这个模块的是这个心态，认为自己可以直接学习sqlalchemyORM封装就行了，不用学习SQL语句。这是错误的。要学好sqlalchemy必须先学习好SQL语句，要完全发挥出sqlalchemy的威力，也必须先学会SQL语句和对应的SQL实现。然后还有一个误区，我们在使用上也不一定要使用orm层的接口。实际上sqlalchemy这个模块里面内容是很丰富的，是很灵活的。它是可以完全取代sqlite3模块和psycopg2模块等初级的DB API，然后还提供了高级的ORM封装。</p>
<h3 id="_2">安装</h3>
<p>sqlalchemy的安装简单用pip3命令安装之即可:</p>
<div class="highlight"><pre><span></span>sudo pip3 install sqlalchemy
</pre></div>
<h3 id="_3">引用惯例</h3>
<p>在后面都默认有如下引用:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
<p>后面将不会再提及，也就是凡是 <code>from sqlalchemy import what</code> 的所有语句也都归于如上一条引用。</p>
<h2 id="_4">简介</h2>
<p>通过sqlalchemy连接具体的某个数据库，前面有一些准备工作要做，参考 <a href="http://www.aosabook.org/en/sqlalchemy.html">sqlalchemy architecture</a> 一文的描述:</p>
<p><img alt="img" src="/images/python/layers.png" title="SQLAlchemy layer diagram"/></p>
<p>和数据库直接相连的是我们熟悉的那些DBAPI接口模块，比如: sqlite3, pymysql, psycopg2等，然后中间的核心层有Engine，连接池，方言 …</p>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/alembic-module.html">alembic模块  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#shu-ju-ku-ref">数据库
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-07-01T00:00:00+08:00">2018年 7月 1日
                            </time>
                        </div>
                    </section>
                    
<p>alembic模块有什么，如果读者熟悉django的话，那么可以将其类比为django里面的makemigrations和migrate相关的命令，简单来说，其管理数据库版本，进行数据库迁移工作。随着我们对于数据库操作的使用频繁，我相信读者就会开始慢慢感受到数据库迁移管理的必要性，实际上我相信读者会从一开始不愿意将这些东西加入代码版本控制，到后来开始主动要将其加入代码版本控制。</p>
<p>更多关于alembic的使用请参看官方文档，下面就一些基本的使用概念说一下。</p>
<h2 id="_1">基本使用</h2>
<h3 id="alembic">初始化alembic项目</h3>
<div class="highlight"><pre><span></span>alembic init alembic
</pre></div>
<p>然后当前目录下会多一个 <code>alembic.ini</code> 文件，这个配置文件里面有很多重要的配置，其中 <code>sqlalchemy.url</code> 是必配的。</p>
<h3 id="modelspy">根据models.py来</h3>
<p>类似于django的 models.py 文件里面定义一些模型，我们利用sqlalchemy模块也可以定义一些模型文件，然后根据这个模型文件的定义，我们可以利用alembic来自动根据你的数据库的一些更改：</p>
<div class="highlight"><pre><span></span>alembic revision --autogenerate -m "add_some_key"
</pre></div>
<p>你需要定义好 alembic 文件下的 <code>env.py</code> 里面的 target_metadata 这个变量：</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">myapp …</span></pre></div>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/pandasmo-kuai.html">pandas模块  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#ji-qi-xue-xi-ref">机器学习
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-07-01T00:00:00+08:00">2018年 7月 1日
                            </time>
                        </div>
                    </section>
                    
<p>本文对pandas模块的一些核心概念进行说明。</p>
<h2 id="_1">基本入门</h2>
<p>pandas最核心的两个数据结构就是 Series 类和 DataFrame 类。其中DataFrame可能会用的偏多一点，Series相当于一维情况下较简单的DataFrame，有的时候会用到。本文重点讨论DataFrame类。</p>
<p>DataFrame之所以很常用是因为这种数据结构太常见了，在excel中，在csv中，在sql中，等等来源的数据都可以汇总成为DataFrame数据结构，然后进行一些后面必要的数据处理，包括送入机器学习或者深度学习的模型中去。</p>
<h2 id="_2">读写文件支持</h2>
<p>pandas的io子模块写得很便捷，实际上我经常看到有些python程序员并不是在做数据处理，有时都会调用下pandas的io来做一些读写操作。</p>
<p>其大体有这些函数：</p>
<ul>
<li>read_csv    to_csv</li>
<li>read_json   to_json</li>
<li>read_html to_html</li>
<li>read_excel to_excel</li>
<li>read_sql to_sql</li>
</ul>
<p>这其中，html的读写在网络抓取上有时可能有用，但不是很强大，还是推荐用专门的工具来做，sql的操作简单点可以用pandas那边的接口，但如果稍微复杂点还是推荐用sqlalchemy来做，这样写出来的代码可读性更好一些，orm层接口也更便捷写，代码里面全是一大堆sql语句，总不是太好的。</p>
<h3 id="txt">读txt文件</h3>
<p>实际上我们可能更常遇到的是txt文件，还是用 read_csv 函数来读，只是需要做一些额外的配置，比如 …</p>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/airflow-module.html">airflow模块  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#pythonhao-huo-ban-ref">python好伙伴
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-24T00:00:00+08:00">2018年 6月 24日
                            </time>
                        </div>
                    </section>
                    
<h2 id="_1">前言</h2>
<p>airflow和luigi模块相比有以下优点：</p>
<ol>
<li>通用的DAG概念来描述工作流，更专业点。</li>
<li>集成系统的crontab从而支持周期性任务，这样airflow就只能在linux系统下运行了。</li>
<li>图形界面很美观，功能更强大。</li>
</ol>
<p>老实说我不喜欢crontab，如果只是简单调度，用apscheduler或者之类的工具简单写下就能集成到你的软件系统中去，而再复杂点的工作流，任务流程等等管理，都推荐使用airflow这样的框架来管理。</p>
<p>而至于说到大数据上的那些流式数据处理工具，实际上只有百分之几的公司因为业务需要必须上大数据，大部分公司是没必要上大数据的，因为大数据引入了太多的复杂度了，如果没有必要，而仅仅追求时髦去玩大数据，那显然是违背我们程序界公认的KISS原则的【Keep it simple and stupid.】。</p>
<h3 id="airflow">安装airflow</h3>
<div class="highlight"><pre><span></span>pip install apache-airflow
</pre></div>
<h3 id="_2">推荐起步</h3>
<p>推荐 项目工作目录下 <code>.env</code> 文件下写上：</p>
<div class="highlight"><pre><span></span>export AIRFLOW_HOME=.
</pre></div>
<p>这样使用pipenv或者其他工具在当前目录激活工作环境的时候，也自动激活了airflow在当前目录下工作的配置。这样我们airflow相关works配置的相关代码都放在这里。</p>
<p>激活虚拟环境后，然后我们有如下操作：</p>
<h3 id="_3">初始化数据库</h3>
<div class="highlight"><pre><span></span>airflow initdb
</pre></div>
<h3 id="webserver">启动webserver</h3>
<div class="highlight"><pre><span></span>airflow webserver
</pre></div>
<h2 id="_4">使用其他数据库</h2>
<p>刚开始玩下sqlite3数据库 …</p>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/sqlshu-ju-ku-ji-chu.html">sql数据库基础  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#ji-chu-ref">基础
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-24T00:00:00+08:00">2018年 6月 24日
                            </time>
                        </div>
                    </section>
                    
<p>本小节主要结合sqlite3来简要说明sql数据库的一些基本理论知识。至于其他SQL数据库比如mysql，postgresql等具体实现的相关知识本文不会讨论。</p>
<h2 id="_1">基本术语</h2>
<p>数据库（database）简单的理解就是一个文件柜。然后DBMS（database management system）是数据库管理系统。而所谓的 <strong>table</strong> 表你可以将其看作文件柜里的一个结构化了的文件。在表格里面的数据都是 <em>按行存储</em> 的，这个要在头脑中牢记。然后一行数据称之为一个 <strong>记录</strong>  。SQL（Structured Query Language）的意思是结构化查询语言。</p>
<p>sqlite3的安装就不罗嗦了，若有问题请从网络查阅之。</p>
<h2 id="_2">第一个例子</h2>
<p>sqlite3和postgresql不同，其没有客户端/服务器的概念，就是直接的文件管理，sqlite3的数据库就是一个文件，然后如果连接到某个不存在的文件，就会自动创建对应的数据库文件。删除数据库当然就是删除数据库文件即可，这一块sqlite3很简单。</p>
<p>现在我们往这个数据库里面加入一点东西:</p>
<div class="highlight"><pre><span></span>wanze@wanze-ubuntu64:~/桌面$ sqlite3 mydb
SQLite version 3.8.2 2013-12-06 …</pre></div>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/makefileni-bu-lai-yi-fa-ma.html">makefile你不来一发吗  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#linux-ref">linux
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-18T00:00:00+08:00">2018年 6月 18日
                            </time>
                        </div>
                    </section>
                    
<h2 id="makefile">简单了解下makefile</h2>
<p>makefile一般只能在Linux环境下运行，更确切来说要有gnu make这个工具去运行Makefile这个文件。</p>
<p>makefile里面内容其实很丰富的，实际上甚至有点过于复杂了。不过有的时候只是简单使用其基本功能还是很便利的。</p>
<div class="highlight"><pre><span></span><span class="nv">project</span><span class="o">=</span>helloworld
<span class="nv">cflags</span><span class="o">=</span>-g -Wall  <span class="si">${</span><span class="nv">CCFLAGS</span><span class="si">}</span>

<span class="nf">${project}</span><span class="o">:</span> 
    <span class="si">${</span><span class="nv">CC</span><span class="si">}</span>  helloworld.c -o <span class="nv">$@</span> <span class="si">${</span><span class="nv">cflags</span><span class="si">}</span>

<span class="nf">clean</span><span class="o">:</span>
    rm <span class="si">${</span><span class="nv">project</span><span class="si">}</span>

<span class="nf">install</span><span class="o">:</span>
    cp <span class="si">${</span><span class="nv">project</span><span class="si">}</span> /usr/local/bin

<span class="nf">uninstall</span><span class="o">:</span>
    rm /usr/local/bin/<span class="si">${</span><span class="nv">project</span><span class="si">}</span>

<span class="nf">.PHONY</span><span class="o">:</span>
    clean uninstall install
</pre></div>
<p>为了便于理解，上面这个makefile我有意采用了一种和bash shell接近的风格。前面 <code>project=</code> 就是一个定义变量的行为。这个project变量就是本脚本的名字。然后makefile下面的主体部分格式如下:</p>
<div class="highlight"><pre><span></span><span class="nf">target</span><span class="o">:</span> <span class="n">prerequisites</span>
    the <span class="nb">command …</span></pre></div>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/python2he-python3de-jian-rong-xing.html">python2和python3的兼容性  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#pythonyu-yan-ref">python语言
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-18T00:00:00+08:00">2018年 6月 18日
                            </time>
                        </div>
                    </section>
                    
<h2 id="2to3">2to3内置模块</h2>
<p>python有个 <strong>2to3</strong> 内置模块可以自动进行python2脚本到python3脚本的移植工作，不过我感觉最好是不要过分依赖这个工具，这只是适合初学者的。因为python2和python3很多地方不一样了。如果你对这个模块有很深的了解，可能自己手工进行修改会更合适一些（其中可能会涉及到新的编写思路）。具体模块的使用请参看官方文档。</p>
<h2 id="_1"><code>//</code> 和 <code>/</code></h2>
<p>在python2中，两个整数相除会返回一个整数，也就是python3的 <code>//</code>。</p>
<div class="highlight"><pre><span></span>&gt;&gt;&gt; 5/2
2
</pre></div>
<h3 id="_2">兼容方案</h3>
<p>在文件头上加上一行：</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
</pre></div>
<p>这样就都是使用python3的语法规则，即:  <code>/</code> 表示常规除法， <code>//</code> 表示整除——返回商。</p>
<h2 id="print">print函数</h2>
<p>这是最常见的错误了，推荐第一步就在文档里面进行find print这个字符串操作，然后将所有：</p>
<div class="highlight"><pre><span></span>    print ...
</pre></div>
<p>这样的形式都换成：</p>
<div class="highlight"><pre><span></span>    print(...)
</pre></div>
<p>这是目前python2和python3都兼容的形式了，所以没有什么好犹豫的，大胆的修改就是了。</p>
<p>其中python2 </p>
<div class="highlight"><pre><span></span>    print 1, 2,
</pre></div>
<p>似乎还有点小复杂，简单的理解就是对应到python3的</p>
<div class="highlight"><pre><span></span>    print(1, 2, end …</pre></div>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/ji-suan-ji-wang-luo-ji-chu.html">计算机网络基础  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#ji-chu-ref">基础
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-17T00:00:00+08:00">2018年 6月 17日
                            </time>
                        </div>
                    </section>
                    
<h2 id="_1">先找到目标计算机</h2>
<p>首先让我们简单回顾一下在学习Linux系统时接触到的网络知识，Internet源起于美国的ARPAnet项目，其有个基本的知识点就是 <strong>只有两个位于同一网域的计算机才可以直接进行文件交互</strong> 。那么读者就会问了什么是网域，所谓网域说白了就是把一个大的互联网分割分割再分割的一个产物。而分割手段就是 <strong>子网掩码</strong> ，怎么判断两个计算机是同一网域呢？就是把这个计算机的IP地址和子网掩码相加，结果相同我们就说他们位于同一网域。</p>
<p>现在我们说一台计算机要对另外一台计算机发送一个信息包，首先这个计算机会分析自己的路由表，如果发现目标机器和自己在同一网域，那么就直接发送信息了。如果不在同一网域，那么这个计算机就要根据路由表将这个信息包发送给默认的路由器（gateway）。路由器或者交换机在网络世界里扮演着一个特殊的角色，那就是它们不具体处理数据，只负责数据分发。具体过程实际上就是上面描述的过程的不断迭代重复，也就是路由器也有一个自己的路由表，然后看看目标机器是不是和自己在同一网域等等，如果不则将信息包发送给另外一个默认的路由器或交换机之类的等等，直到最终目标机器和自己位于同一网域，然后将信息包发送给目标机器。</p>
<h2 id="_2">通信协议</h2>
<p>计算机找到目标计算机了就可以开口说话了，但是不能随便说话也就是发送一堆乱码过去，那样目标机器是看不懂的。这个时候我们就需要制定计算机之间的通信协议。那么什么是计算机之间的通信协议？简单来说就好比两个人之间对话的某种规范，或者两个国家进行外交协商的某种特定交互流程。比如一个人对另外一个人说"你好"，另外一个人收到则回应"你好"，表明我已经收到了，然后第一个如果收到这个回应，则表明协议牵手成功，然后继续进行其他会话，比如"今天星期几"，发送过去，然后另外一个人收到之后回应"今天星期一"……就是类似这样的交互方式 …</p>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/pythonyu-yan-xue-xi-zhi-xue-xi-zi-liao-zheng-li.html">python语言学习之-学习资料整理  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#pythonyu-yan-ref">python语言
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-17T00:00:00+08:00">2018年 6月 17日
                            </time>
                        </div>
                    </section>
                    
<ul>
<li>
<p>python入门教程，python官网上的tutorial。原作者：Guido van Rossum  Fred L. Drake ；中文翻译：刘鑫等；版本：2013-10-28；pdf下载链接：<a href="https://drive.google.com/open?id=0ByWxOeitx54PSW40bU5zNVhuMlU&amp;authuser=0">python入门教程</a>  。</p>
</li>
<li>
<p>learning python，主要python语言参考，我主要参看了python学习手册（第四版）。原作者：Mark Lutz，中文翻译：李军，刘红伟等。</p>
</li>
<li>
<p>programming python，作者Mark Lutz对python编程的进阶讨论；版本：第四版。</p>
</li>
<li>
<p>python <a href="https://docs.python.org/3/">官网上的资料</a> 。</p>
</li>
<li>
<p>第三方模块参考手册，如numpy, scipy, matplotlib等等第三方模块官网上发布的官方参考手册。</p>
</li>
<li>
<p>dive into python3 <a href="http://www.diveintopython3.net/index.html">english version</a> , 这是<a href="http://sebug.net/paper/books/dive-into-python3/index.html">中文版</a> 。</p>
</li>
<li>
<p>A Guide to Python's Magic …</p></li></ul>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/docker.html">docker入门  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#tools-ref">tools
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-14T00:00:00+08:00">2018年 6月 14日
                            </time>
                        </div>
                    </section>
                    
<h2 id="_1">前言</h2>
<p>关于docker是什么请参看 <a href="https://docker_practice.gitee.io/introduction/what.html">这个网页</a> ，说docker将改变软件生态确实是不为过的。老实说在接触docker之后感觉之前学到的很多东西，比如linux系统相关的一些，ansible等等部署工具相关的一些，virtualbox和 vagrant相关的一些，都在慢慢过时和淘汰了。当然那些工具还是很有用的，说他们被淘汰了是有点过了，更确切来说，对于一般玩家来说，可以节省更多的精力和时间，而不需要折腾那些工具那些配置学习折腾个老半天了。</p>
<blockquote>
<p>That‘s why we love docker.</p>
</blockquote>
<p>但实际上docker带来的变化远远不止于只是一个可以节省开发者做某些事情的时间的一个不错的工具那么简单，其伴随着SPPS，软件即服务，更确切来说整个互联网的大背景下，应运而生的。与之相应的，开发者们顺应这个时代，在编码，软件应用的很多方面，都需要做出改变。请读者进一步阅读 https://12factor.net/zh_cn/ 里面的讨论。</p>
<p>实际上之前我折腾vagrant的时候，就很是认同这个理念： 那就是开发，测试，生产一致的环境，彻底解决，在这里可以运行，在这里就不行了的问题。而vagrant的控制virtualbox创建虚拟机的方式，在我看来显得略微笨拙了点，配置的繁琐，似乎并没有很好地解决这个问题 …</p>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/python-dateutilmo-kuai.html">python-dateutil模块  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#pythonhao-huo-ban-ref">python好伙伴
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-14T00:00:00+08:00">2018年 6月 14日
                            </time>
                        </div>
                    </section>
                    <p>一般能够使用python的内置模块datetime解决的问题或者简单写几个辅助函数就能解决的问题是没必要上 python-dateutil 模块的，但有的时候某些问题，上python-dateutil模块会非常的方便，然后我发现好多有名的模块都默认安装这个模块了。</p>
<h2 id="relativedelta">relativedelta</h2>
<p>某些问题，用datetime的replace将某个值设为0或者什么值，或者用timedelta来减去什么值，大部分都能解决，但有的时候，比如跨月份涉及到要考虑天数不等或者其他等等问题，用relativedelta还是很方便的。</p>
<p>总的说来涉及到datetime的某个跨度的计算问题，还是推荐使用 relativedelta函数。</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dateutil.relativedelta</span> <span class="kn">import</span> <span class="n">relativedelta</span>
<span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
<span class="n">sdt</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">relativedelta</span><span class="p">(</span><span class="n">months</span><span class="o">=</span><span class="n">months</span><span class="p">)</span>
</pre></div>


<h2 id="rrule">rrule</h2>
<p>虽然没有lrule，但根据上面的relativedelta配置的起始时间，然后指定结束时间，通过rrule函数来生成一个时间区间，有时是很方便的。</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dateutil.rrule</span> <span class="kn">import</span> <span class="n">rrule</span><span class="p">,</span> <span class="n">MONTHLY</span>
<span class="nb">list</span><span class="p">(</span><span class="n">rrule</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="n">MONTHLY</span><span class="p">,</span> <span class="n">dtstart</span><span class="o">=</span><span class="n">sdt</span><span class="p">,</span> <span class="n">until</span><span class="o">=</span><span class="n">now …</span></pre></div>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/pythonpa-chong-zhi-biao-dan-he-deng-lu-deng-xiang-guan.html">python爬虫之-表单和登陆等相关  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#pythonpa-chong-ref">python爬虫
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-14T00:00:00+08:00">2018年 6月 14日
                            </time>
                        </div>
                    </section>
                    
<p>表单简单来说就是一个前端友好的界面，其实质就是发送了 一个 POST 请求。</p>
<p>关键是要理解前端的表单界面，具体POST了哪些参量。</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">action=</span><span class="s">"???"</span>
    <span class="err">&lt;input</span> <span class="na">type=</span><span class="s">...</span> <span class="na">name=</span><span class="s">"firstname"</span> <span class="err">...</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="err">type</span> <span class="err">...</span>
    <span class="err">submit</span>
<span class="err">&lt;/form</span><span class="nt">&gt;</span>
</pre></div>
<p>input 的  <strong>name</strong> 就是具体 POST 的参量，然后就是action那边就是你要 POST 的目的地。</p>
<p>类似的表单还有很多其他元素，比如checkbox之类的，其都不过是为了让用户快速地设置某个参量罢了。</p>
<h2 id="cookies">登录的cookies问题</h2>
<p>因为http无状态，所以有cookies 和 session ，服务端数据库记录session，cookies就是客户端。爬虫要正常登录，记得保留好登录成功之后的cookies。</p>
<p>多次请求的时候，用requests的cookies保存和设置就不好用了。记得使用requests的session机制。</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'username' …</span></pre></div>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/pythonpa-chong-zhi-fang-zhi-bei-feng-de-ce-lue.html">python爬虫之-防止被封的策略  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#pythonpa-chong-ref">python爬虫
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-14T00:00:00+08:00">2018年 6月 14日
                            </time>
                        </div>
                    </section>
                    
<p>防止被封的首要策略就是尽量的为别人的服务器多考虑下，让自己写的爬虫少请求，每次请求都是有效的核心请求获取最核心的数据，不管是刷页面还是刷ajax，多次请求之间应该设置一个停顿时间。</p>
<div class="highlight"><pre><span></span>time.sleep(3)
</pre></div>
<p>在上面的首要原则的基础上，下面介绍的很多实战技巧，其实都符合一个大的原则：尽可能地让你的爬虫和人浏览网页没有区别。</p>
<h2 id="http">http请求头调整</h2>
<p>user-agent 设置，而且时不时的切换下。</p>
<p>虽然目前还没有遇到，不过我推测可能 Referrer 这个header在某些场景下是有些文章的。</p>
<p>还有 Accept-Language 也可能有用。</p>
<h2 id="cookies">Cookies</h2>
<p>有些情况下cookies的正常获取需要javascript的支持。cookies总的原则是第一次请求获取到cookies，然后后面的很多次请求都使用这个cookies即可。</p>
<p>不过反爬虫cookies一般都会有个时间限制，一个简单的做法就是这边也设置个时间，定时获取最新的cookies或者，一定请求量之后再获取一个新的cookies。</p>
<p>具体使用 scrapy-splash 了解下。</p>
<h2 id="_1">表单陷阱</h2>
<p>有的表单里面有：</p>
<div class="highlight"><pre><span></span>&lt;input type="hidden" ...
</pre></div>
<p>我们要记住人如果在页面上点击，这个没有显示的字段的值也会一并送过去，而他们服务器那边会根据这个值可能是个加密的某个值来判断这个请求是人点的还是爬虫行为。</p>
<p>最好的策略是先把整个表单内容爬过来，收集好之后再发送表单请求。</p>
<p>和上面的情况相反，还有一种情况，页面表单发送可能有特别的处理，某些表单字段，不管用户看得见看不见，你都不能发送过去 …</p>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/pythonpa-chong-zhi-zi-ran-yu-yan-chu-li-xiang-guan.html">python爬虫之-自然语言处理相关  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#pythonpa-chong-ref">python爬虫
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-14T00:00:00+08:00">2018年 6月 14日
                            </time>
                        </div>
                    </section>
                    <p>网页里面的内容大部分是文本，所以爬虫继续深入不可避免要研究自然语言处理的。</p>
<p>爬虫越学到后面就会明白，漫无目的的爬虫真的只是入门阶段，而爬虫进阶很多时候就要在这个爬虫定向上下功夫。</p>
<p>本文不是介绍自然语言处理相关知识的，只是就和爬虫相关做一些讨论和思考。</p>
<p>比如分析文章得到热门词，然后根据热门词进一步定向搜索定向爬取。</p>
<p>但在这里我们说得更加抽象一点，而这就是爬虫进阶和自然语言处理结合的理想状态，简言之就是：</p>
<p>好像一个人在阅读一篇文章，然后真的理解了里面的文章和里面的词语，然后他自己去决定哪个url该点，哪个关键词该收集，那篇文章有价值，那篇文章该分到哪一类等等。</p>
<p>下面列出一些自然语言处理的基本功，想要爬虫进阶深造的可能就要开始把这些基本功打扎实了：</p>
<ul>
<li>分词</li>
<li>词频统计</li>
<li>ngram模型等分析词语之间的关系</li>
<li></li>
</ul>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/pythonpa-chong-zhi-zi-ti-fan-pa-chong.html">python爬虫之-字体反爬虫  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#pythonpa-chong-ref">python爬虫
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-14T00:00:00+08:00">2018年 6月 14日
                            </time>
                        </div>
                    </section>
                    
<p>在爬虫的时候，你分析网页会看到，某些东西看上去是乱码，其css设置了一种额外的字体。怎么破解里面的内容呢？</p>
<p>首先你需要把目标字体下载下来，通常这种字体有各种各样的名字，里面的具体字体codepoint也是随机的...</p>
<p>如果你下载一个fontcreator会看到具体哪个字对应哪个codepoint，而爬虫这边编码，我们需要使用python的 fonttools库来加载字体。</p>
<p>首先你需要下载好字体，保存好字体做好缓存工作。</p>
<p>见本文的参考资料2，然后就是利用 fonttools 模块加载目标字体。</p>
<div class="highlight"><pre><span></span>font = TTFont(font_filename)
</pre></div>
<p>然后就是分析这个字体的cmap tables的cmap数据，不同的字体似乎情况不同，这个要实际分析，由于fonttools这个模块文档较少，加上我对字体知识不太多，所以只能简单摸索下了。</p>
<div class="highlight"><pre><span></span>font_mapping = font['cmap'].tables[?].cmap
</pre></div>
<p>如果你找到 font_mapping 了，字符 用python的 ord 函数处理下，就能得到目标字符的 unicode code point，也就是我们上面说的字体的code point，在这个 font_mapping 里面你会看到的，然后具体什么内容就出来了 …</p>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/pythonzhong-de-wei-cao-zuo.html">python中的位操作  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#pythonyu-yan-ref">python语言
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-14T00:00:00+08:00">2018年 6月 14日
                            </time>
                        </div>
                    </section>
                    
<p>位操作似乎用c语言会更方便，不过我们可以先把这块概念弄清楚，然后迁移到c代码是很方便的。</p>
<h2 id="1">问题1，如何表示任意长度的基于字节的 位向量</h2>
<p>比如说我想表达 01010101010101 
答： </p>
<div class="highlight"><pre><span></span>0b01010101010101
</pre></div>
<h2 id="2">问题2 上面任意长度的位向量，我如何实现遍历逻辑</h2>
<p>是的，我是看编程珠玑确定这些问题的，然后发现python，当然，已经有类似的实现库了： <a href="https://github.com/ilanschnell/bitarray">https://github.com/ilanschnell/bitarray</a></p>
<p>下面好好研究下这个项目的源码。</p>
<h3 id="4">问题4 如何建立位图映射</h3>
<p>比如 0b1010101010 -&gt; 对应的是 数字集合 {1,3,5,7,9}</p>
<h3 id="5">问题5 有没有可能建立其他位图映射</h3>
<h2 id="3">问题3 常规的位操作运算符，你帮我说说吧</h2>
<h3 id="_1">按位与</h3>
<div class="highlight"><pre><span></span>x = 0b111101010
y = 0b101010101
print(bin(x))
print(bin …</pre></div>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/shi-yong-cythonlai-jia-su-python.html">使用cython来加速python  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#pythonhao-huo-ban-ref">python好伙伴
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-14T00:00:00+08:00">2018年 6月 14日
                            </time>
                        </div>
                    </section>
                    
<h2 id="_1">找到性能瓶颈所在</h2>
<p>首先需要确认脚本或者某个函数具体到底是哪里出现了性能瓶颈：</p>
<div class="highlight"><pre><span></span>python -m cProfile test.py
</pre></div>
<p>或者使用jupyter notebook 的timeit 功能，或者自己写 time计时。</p>
<p>目前我知道的循环结构提速很明显，然后指定静态类型会提速。</p>
<p>一般的python代码cython都是支持的，但一般我们是重点去开发那个限速的目标函数，而不会到处优化的。</p>
<p>参考资料1的例子，没有加速，N设置为3000，用时 53.301s，加速之后，用时4.186s。然后没有加速的那个exp运算了很多很多次，大概花了一两秒的样子，所以我们看到原始python代码在循环操作上开销很大。某些关键计算如果循环次数太多，那么就要考虑上c扩展优化了。</p>
<p>在做性能测试的时候有一类耗时较多的操作是不用考虑c代码优化的，这类耗时多的操作就是IO等待型操作，有的是等待数据库IO操作，有的是等待文件读写IO操作，有的是等待网络IO请求等等。这些请求很多都和socket套接字请求相关。</p>
<h2 id="pyx">pyx文件</h2>
<p>关于pyx文件的更多请查看cython的官方手册。</p>
<p>下面重点讲一下 python模块包的管理方案，推荐是利用 setuptools 来，</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span><span class="p">,</span> <span class="n">find_packages …</span></pre></div>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/12factor-app-talk.html">软件即服务的12因素方法论  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#she-ji-ref">设计
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-13T00:00:00+08:00">2018年 6月 13日
                            </time>
                        </div>
                    </section>
                    
<p>本文主要学习 <a href="https://12factor.net/zh_cn/">这个网站</a> ，这个网站提出了软件即服务架构的12因素方法论。在目前软件开发，部署docker化，微服务，云服务，分布式架构等大趋势下，软件即对外提供一种http api服务的定位是很具有普遍性的。本文的一些讨论是很值得我们细细去思考的。</p>
<h2 id="_1">前言</h2>
<p>Adam Wiggins 研究了数以百计的应用程序的开发和部署，并在Heroku平台上数十万应用程序的开发运作和扩展过程，写作了这个博客： <a href="https://12factor.net/zh_cn/">https://12factor.net/zh_cn/</a> 。</p>
<p>在互联网Internet的大背景下，软件作为一种服务，更确切来说作为一种api服务而存在是一种具有普适性的架构模式，不管软件自身功能如何，但软件本身只是一个提供了一些对外api接口的工具的定位，无疑是面向整个互联网和面向未来的。</p>
<p>同时这里的讨论不光涉及到部署和运维，实际上，在软件开始编写时的架构设计和具体编码部分内部细节，编码者的思路也需要作出相应的调整。</p>
<h2 id="_2">总的原则</h2>
<ul>
<li>使用<strong>标准化</strong>流程自动配置，从而使新的开发者花费最少的学习成本加入这个项目。</li>
<li>和操作系统之间尽可能的<strong>划清界限</strong>，在各个系统中提供<strong>最大的可移植性</strong>。</li>
<li>适合<strong>部署</strong>在现代的<strong>云计算平台</strong>，从而在服务器和系统管理方面节省资源。</li>
<li>将开发环境和生产环境的<strong>差异降至最低</strong>，并使用<strong>持续交付</strong>实施敏捷开发 …</li></ul>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/pythonyu-yan-zhi-dan-li-mo-shi.html">python语言之-单例模式  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#pythonyu-yan-ref">python语言
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-13T00:00:00+08:00">2018年 6月 13日
                            </time>
                        </div>
                    </section>
                    
<p>某些情况下你需要确保某个类只有一个实例，这叫做单例模式。</p>
<p>python中的对象有 <code>__new__</code> 方法 和 <code>__init__</code> 方法，其中 <code>__new__</code> 方法会返回你的类具体创建的实例，而 <code>__init__</code> 方法仅仅和你的实例化初始化之后的一些额外动作相关。</p>
<p>于是我们有：</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SingleInstance</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s1">'_instance'</span><span class="p">):</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">SingleInstance</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span>
</pre></div>
                </article>


                <article>

                    <h1 class="page-header"><a href="/articles/pythonyu-yan-zhi-formathan-shu.html">python语言之-format函数  </a></h1>

                    <section>
                        posted in
                        <a href="/categories.html#pythonyu-yan-ref">python语言
                        </a>
                        <div class="recent-posts-time">
                            <time pubdate="pubdate" datetime="2018-06-13T00:00:00+08:00">2018年 6月 13日
                            </time>
                        </div>
                    </section>
                    <p>format函数或者说字符串的format方法，一般的使用还是很简单的，但是有的时候有些特殊的高级需求，下面渐渐收集之。</p>
<h2 id="_1">等宽数字</h2>
<div class="highlight"><pre><span></span> {:0&gt;2d} 
</pre></div>


<p>目标数字宽度为两位，左边填充0 ， <code>&gt;</code> 表示左边填充， <code>0&gt;</code> 表示左边填充0，此外还有 <code>&gt;</code> 表示右边填充。</p>
                </article>

  <nav aria-label="Page Navigation">
    <ul class="pager">
        <li class="previous">
            <a href="/index2.html" aria-label="Previous" >
                <span aria-hidden="true">&larr;<span>Previous</span></span>
            </a>
        </li>


        <li class="next">
            <a href="/index4.html" aria-label="Next" >
                <span aria-hidden="true">&rarr;<span>Next</span></span>
            </a>
        </li>

    </ul>
</nav>
             </div>
        </div>
    </div>
</div>




    </div>
    <div class="col-md-1"></div>

</div>


<div id="push"></div>


<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a> and updated by <a href="http://www.cdwanze.work" title="cdwanze Home Page">cdwanze</a></li>
    </ul>
</div>
</footer>

 <script src="/theme/js/jquery.min.js"></script>
<script src="/theme/js/bootstrap.min.js"></script>
<script>
    function validateForm(query) {
        return (query.length > 0);
    }
</script>



<script>
    (function ($) {
        // custom css expression for a case-insensitive contains()
        jQuery.expr[':'].Contains = function (a, i, m) {
            return (a.textContent || a.innerText || "").toUpperCase().indexOf(m[3].toUpperCase()) >= 0;
        };

        function listFilter() {

            $('#findtag')
                .change(function () {
                    var filter = $(this).val();
                    if (filter) {
                        // this finds all links in a list that contain the input,
                        // and hide the ones not containing the input while showing the ones that do
                        $('.list-of-tags').find("a:not(:Contains(" + filter + "))").parent().hide();
                        $('.list-of-tags').find("a:Contains(" + filter + ")").parent().show();
                    } else {
                        $('.list-of-tags').find("li").show();
                    }
                    return false;
                })
                .keyup(function () {
                    // fire the above change event after every letter
                    $(this).change();
                });
        }

        //ondomready
        $(function () {
            listFilter($());
        });
    }(jQuery));

</script> 

<script>
    $(function(){
        //点击回到顶部的元素
        $("#gotop").click(function(e) {
                //以1秒的间隔返回顶部
                $('body,html').animate({scrollTop:0},1000);
        });
    });
</script>

<script>
  $('.page-header').hover(function(){
    $(this).css("color",'#3875d7')
  }, function(){
    $(this).css('color','#8B0000')
  })
</script>


<script>
  $(document).ready(function(){
    $('a.slowscroll').click(function(event){
      var $anchor = $(this);
      $('html, body').animate({scrollTop: $($anchor.attr('href')).offset().top},1500);
      event.preventDefault();
      // $('a.slowscroll').parent().removeClass('active');
      // $('.navbar-header').hide();
      // $anchor.parent().addClass('active');
    })
  })
  console.log('document init...')
</script>




</body>
</html>